./peerA-R3S ike_alg_register_enc(): Activating OAKLEY_AES_CBC: Ok (ret=0)
./peerA-R3S ike_alg_register_hash(): Activating OAKLEY_SHA2_512: Ok (ret=0)
./peerA-R3S ike_alg_register_prf(): Activating prf-hmac-sha2-512: Ok (ret=0)
./peerA-R3S ike_alg_register_hash(): Activating OAKLEY_SHA2_256: Ok (ret=0)
./peerA-R3S ike_alg_register_prf(): Activating prf-hmac-sha2-256: Ok (ret=0)
./peerA-R3S ike_alg_register_hash(): Activating OAKLEY_SHA1: Ok (ret=0)
./peerA-R3S ike_alg_register_prf(): Activating prf-hmac-sha1: Ok (ret=0)
./peerA-R3S ike_alg_register_hash(): Activating OAKLEY_MD5: Ok (ret=0)
./peerA-R3S ike_alg_register_prf(): Activating prf-hmac-md5: Ok (ret=0)
./peerA-R3S registered kernel encr algorithm aes_cbc [12, 128<=key<=512]
./peerA-R3S registered kernel encr algorithm 3des [3, 192<=key<=192]
./peerA-R3S registered kernel integ algorithm hmac_sha1_96 [2, 160<=key<=160]
./peerA-R3S registered kernel integ algorithm hmac_md5_96 [1, 128<=key<=128]
./peerA-R3S registered kernel integ algorithm hmac_sha2_256_128 [12, 256<=key<=256]
./peerA-R3S registered kernel integ algorithm hmac_sha2_512_256 [14, 256<=key<=256]
./peerA-R3S adjusting ipsec.d to ../samples/davecert
./peerA-R3S loading secrets from "../samples/davecert.secrets"
./peerA-R3S   loaded private key file '../samples/davecert/private/daveKey.pem' (CERT bytes)
./peerA-R3S loaded private key for keyid: PPK_RSA:AwEAAeOoT/75B9 7996 96CB FFE9 9CEA F984 D596 602E 42AE 6535
| processing whack message of size: A
./peerA-R3S Adding new connection peerA--peerB with policy RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   loading certificate from daveCert.pem
./peerA-R3S   loaded host cert file '../samples/davecert/certs/daveCert.pem' (CERT bytes)
| certificate is valid
| counting wild cards for C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org is 0
| counting wild cards for C=CA, ST=ON, O=Xelerance, CN=* is 1
| based upon ID_wildcard policy, the connection is a template.
| orient peerA--peerB checking against if: eth0 (AF_INET6:fe80::8054:3eff:fe9a:d3f4:500)
|     orient matched on IP
|   orient peerA--peerB finished with: 1 [fe80::8054:3eff:fe9a:d3f4]
| find_host_pair: looking for me=fe80::8054:3eff:fe9a:d3f4:500 %address him=fe80::ec68:7cff:fe0c:9aa4:500 exact-match
| find_host_pair: concluded with <none>
| connect_to_host_pair: fe80::8054:3eff:fe9a:d3f4:500 %address fe80::ec68:7cff:fe0c:9aa4:500 -> hp:none
| find_ID_host_pair: looking for me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=<any> (exact)
|   concluded with <none>
| added connection: "peerA--peerB"
| ::/0===fe80::8054:3eff:fe9a:d3f4[C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org]...fe80::ec68:7cff:fe0c:9aa4[C=CA, ST=ON, O=Xelerance, CN=*]===::/0
| ike_life: 3600s; ipsec_life: 1200s; rekey_margin: 180s; rekey_fuzz: 100%; keyingtries: 1; policy: RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   orient peerA--peerB finished with: 1 [fe80::8054:3eff:fe9a:d3f4]
RC=0 "peerA--peerB": ::/0===fe80::8054:3eff:fe9a:d3f4[C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org]...fe80::ec68:7cff:fe0c:9aa4[C=CA, ST=ON, O=Xelerance, CN=*]===::/0; unrouted; eroute owner: #0
RC=0 "peerA--peerB":     myip=unset; hisip=unset; mycert=daveCert.pem;
RC=0 "peerA--peerB":   CAs: 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'...'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
RC=0 "peerA--peerB":   keys: 1:75B9 7996 96CB FFE9 9CEA F984 D596 602E 42AE 6535 2:none...
RC=0 "peerA--peerB":   ike_life: 3600s; ipsec_life: 1200s; rekey_margin: 180s; rekey_fuzz: 100%; keyingtries: 1; firstmsgid: 0
RC=0 "peerA--peerB":   policy: RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK; prio: 0,0; interface: eth0; kind=CK_TEMPLATE
| Changed path to directory '../samples/davecert/cacerts'
./peerA-R3S   loaded CA cert file 'rootCA.pem' (CERT bytes)
|   authcert inserted
| Changed path to directory '../samples/davecert/aacerts'
| Changed path to directory '../samples/davecert/ocspcerts'
| Found -1 items in directory '../samples/davecert/crls'
|
| List of X.509 End Certificates:
|
| NOW, count: 1
|        subject: 'C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org'
|        issuer:  'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|        serial:   0c
|        pubkey:   2048 RSA Key AwEAAeOoT
|        validity: not before Aug 07 01:03:04 UTC 2024 ok
|                  not after  Nov 15 01:03:04 UTC 2026 ok
|        subjkey:  c2:64:69:e8:dc:88:e3:23:58:47:07:86:4b:5e:d4:b3:ea:bc:a7:10
|        authkey:  86:cb:59:12:06:07:df:3f:00:36:b9:64:c6:c5:14:1f:3a:ed:cd:aa
| find_phase1_state: no SA found for conn 'peerA--peerB'
| creating state object #1 at Z
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| inserting state object #1 bucket: 4
./peerA-R3S initiating v2 parent SA
./peerA-R3S STATE_PARENT_I1: initiate
sending 652 bytes for ikev2_parent_outI1_common through eth0:500 [fe80::8054:3eff:fe9a:d3f4:500] to fe80::ec68:7cff:fe0c:9aa4:500 (using #1)
|   8d 0e 0f 10  11 12 13 14  00 00 00 00  00 00 00 00
|   21 20 22 08  00 00 00 00  00 00 02 8c  22 00 01 0c
|   02 00 00 2c  01 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  02 00 00 05  03 00 00 08
|   03 00 00 0c  00 00 00 08  04 00 00 0e  02 00 00 2c
|   02 01 00 04  03 00 00 0c  01 00 00 0c  80 0e 00 80
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 2c  03 01 00 04
|   03 00 00 0c  01 00 00 0c  80 0e 00 80  03 00 00 08
|   02 00 00 05  03 00 00 08  03 00 00 0c  00 00 00 08
|   04 00 00 05  02 00 00 2c  04 01 00 04  03 00 00 0c
|   01 00 00 0c  80 0e 00 80  03 00 00 08  02 00 00 05
|   03 00 00 08  03 00 00 02  00 00 00 08  04 00 00 05
|   02 00 00 2c  05 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  02 00 00 05  03 00 00 08
|   03 00 00 0c  00 00 00 08  04 00 00 0f  00 00 00 2c
|   06 01 00 04  03 00 00 0c  01 00 00 0c  80 0e 00 80
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 02
|   00 00 00 08  04 00 00 0f  28 00 01 08  00 0e 00 00
|   3d a6 6a 81  e2 92 09 be  18 4f a0 1e  5c ed ea 7c
|   7d 7b 3a 21  3e 15 0d 53  5d 17 6a be  1b c5 70 ab
|   34 47 bc 09  14 7c aa 91  9c 8f 81 dc  1e f9 87 cd
|   6a ec fa f3  a5 9e 37 bc  ac 3d fd e1  32 8e e8 b3
|   fe d3 8b f4  7b 50 34 13  33 7a 93 ea  e9 3c 0e 8b
|   bd 48 18 9c  9e 03 70 f2  55 ce 45 22  9f c7 c9 48
|   43 a3 e2 64  b5 5d 43 38  c8 fe f1 d3  06 43 f0 0a
|   e8 6d 61 8c  60 78 d9 98  d3 1b 3b 5e  f5 a6 e8 2f
|   ef 56 ac b4  33 bd 1e 62  b2 3e 0b 17  af 6c b8 31
|   08 d7 19 5a  7b c4 54 c2  13 47 98 c2  cc d2 16 29
|   75 6c 03 fb  1e 9c 9d 21  0c a1 e6 c2  f3 f2 49 2c
|   f6 06 73 c1  96 1e ce 58  81 01 1c cb  16 dc f9 fc
|   c7 93 08 75  58 16 57 71  69 96 66 b7  a9 81 7f f7
|   37 4d 7c 41  38 62 a6 39  00 81 ca 3d  1d fc f7 b5
|   08 38 d4 34  70 22 6c 21  d2 5b 20 a1  d2 ba 2a d1
|   89 f3 20 79  ce ac 1e c2  ec 7d ae 76  94 40 39 a0
|   29 00 00 14  e1 98 9d 37  a8 14 a6 4d  8f f0 7c 08
|   d3 20 e9 e3  29 00 00 1c  00 00 40 04  71 c6 1d 0c
|   a0 a6 22 3b  41 5a 37 ec  dc 7c 2f 46  44 8c 79 25
|   2b 00 00 1c  00 00 40 05  97 ba 1b c9  89 17 f2 d1
|   e4 fd 0d 23  b7 bf cc b4  38 02 c9 d2  00 00 00 10
|   4f 45 ab ab  ab ab ab ab  ab ab ab ab
| #1 complete v2 state transition with STF_OK
./peerA-R3S transition from state STATE_IKEv2_START to state STATE_PARENT_I1
| v2_state_transition: st is #1; pst is #0; transition_st is #0
./peerA-R3S STATE_PARENT_I1: sent v2I1, expected v2R1 (msgid: 00000000/4294967295)
0: input from peerB-I1b.pcap
|   =========== input from pcap file peerB-I1b.pcap ========
| *received 652 bytes from fe80::ec68:7cff:fe0c:9aa4:500 on eth0 (port=500)
|   97 18 19 1a  1b 1c 1d 1e  00 00 00 00  00 00 00 00
|   21 20 22 08  00 00 00 00  00 00 02 8c  22 00 01 0c
|   02 00 00 2c  01 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  02 00 00 05  03 00 00 08
|   03 00 00 0c  00 00 00 08  04 00 00 0e  02 00 00 2c
|   02 01 00 04  03 00 00 0c  01 00 00 0c  80 0e 00 80
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 2c  03 01 00 04
|   03 00 00 0c  01 00 00 0c  80 0e 00 80  03 00 00 08
|   02 00 00 05  03 00 00 08  03 00 00 0c  00 00 00 08
|   04 00 00 05  02 00 00 2c  04 01 00 04  03 00 00 0c
|   01 00 00 0c  80 0e 00 80  03 00 00 08  02 00 00 05
|   03 00 00 08  03 00 00 02  00 00 00 08  04 00 00 05
|   02 00 00 2c  05 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  02 00 00 05  03 00 00 08
|   03 00 00 0c  00 00 00 08  04 00 00 0f  00 00 00 2c
|   06 01 00 04  03 00 00 0c  01 00 00 0c  80 0e 00 80
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 02
|   00 00 00 08  04 00 00 0f  28 00 01 08  00 0e 00 00
|   3d a6 6a 81  e2 92 09 be  18 4f a0 1e  5c ed ea 7c
|   7d 7b 3a 21  3e 15 0d 53  5d 17 6a be  1b c5 70 ab
|   34 47 bc 09  14 7c aa 91  9c 8f 81 dc  1e f9 87 cd
|   6a ec fa f3  a5 9e 37 bc  ac 3d fd e1  32 8e e8 b3
|   fe d3 8b f4  7b 50 34 13  33 7a 93 ea  e9 3c 0e 8b
|   bd 48 18 9c  9e 03 70 f2  55 ce 45 22  9f c7 c9 48
|   43 a3 e2 64  b5 5d 43 38  c8 fe f1 d3  06 43 f0 0a
|   e8 6d 61 8c  60 78 d9 98  d3 1b 3b 5e  f5 a6 e8 2f
|   ef 56 ac b4  33 bd 1e 62  b2 3e 0b 17  af 6c b8 31
|   08 d7 19 5a  7b c4 54 c2  13 47 98 c2  cc d2 16 29
|   75 6c 03 fb  1e 9c 9d 21  0c a1 e6 c2  f3 f2 49 2c
|   f6 06 73 c1  96 1e ce 58  81 01 1c cb  16 dc f9 fc
|   c7 93 08 75  58 16 57 71  69 96 66 b7  a9 81 7f f7
|   37 4d 7c 41  38 62 a6 39  00 81 ca 3d  1d fc f7 b5
|   08 38 d4 34  70 22 6c 21  d2 5b 20 a1  d2 ba 2a d1
|   89 f3 20 79  ce ac 1e c2  ec 7d ae 76  94 40 39 a0
|   29 00 00 14  3f 98 9d 37  a8 14 a6 4d  8f f0 7c 08
|   d3 20 e9 e3  29 00 00 1c  00 00 40 04  49 0b 02 0c
|   ad ca e0 33  2f b2 0d 95  c3 9b c1 e5  d4 c2 70 6f
|   2b 00 00 1c  00 00 40 05  57 bb 48 a3  14 b1 6f 2b
|   12 90 41 fd  6d 20 1a 3d  79 43 7a f7  00 00 00 10
|   4f 45 ab ab  ab ab ab ab  ab ab ab ab
|  processing version=2.0 packet with exchange type=ISAKMP_v2_SA_INIT (34), msgid: 00000000
| I am the IKE SA Responder
| I am this exchange's Responder
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| v2 state object not found
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| v2 state object not found
| now proceed with state specific processing using state #3 responder-V2_init
./peerA-R3S tentatively considering connection: peerA--peerB
| creating state object #2 at Z
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| inserting state object #2 bucket: 2
| received a notify..
| #2 complete v2 state transition with STF_SUSPEND
| selected proposal 1 encr=aes_cbc[128] integ=hmac_sha2_256_128 prf=prf-hmac-sha2-256 modp=OAKLEY_GROUP_MODP2048
| Thinking about sending a certificate request (CERTREQ)
|   my policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   my next payload will be a certificate request
| have CA 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA', send CERTREQ with CA's Key ID
| #2 complete v2 state transition with STF_OK
./peerA-R3S transition from state STATE_IKEv2_START to state STATE_PARENT_R1
| v2_state_transition: st is #2; pst is #0; transition_st is #2
./peerA-R3S STATE_PARENT_R1: received v2I1, sent v2R1 (msgid: 00000000/00000000)
| sending reply packet to fe80::ec68:7cff:fe0c:9aa4:500 (from port 500)
sending 457 bytes for STATE_IKEv2_START through eth0:500 [fe80::8054:3eff:fe9a:d3f4:500] to fe80::ec68:7cff:fe0c:9aa4:500 (using #2)
|   97 18 19 1a  1b 1c 1d 1e  97 03 67 ba  2d 8b a4 1d
|   21 20 22 20  00 00 00 00  00 00 01 c9  22 00 00 30
|   00 00 00 2c  01 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  03 00 00 0c  03 00 00 08
|   02 00 00 05  00 00 00 08  04 00 00 0e  28 00 01 08
|   00 0e 00 00  bd 48 18 9c  9e 03 70 f2  55 ce 45 22
|   9f c7 c9 48  43 a3 e2 64  b5 5d 43 38  c8 fe f1 d3
|   06 43 f0 0a  e8 6d 61 8c  60 78 d9 98  d3 1b 3b 5e
|   f5 a6 e8 2f  ef 56 ac b4  33 bd 1e 62  b2 3e 0b 17
|   af 6c b8 31  08 d7 19 5a  7b c4 54 c2  13 47 98 c2
|   cc d2 16 29  75 6c 03 fb  1e 9c 9d 21  0c a1 e6 c2
|   f3 f2 49 2c  f6 06 73 c1  96 1e ce 58  81 01 1c cb
|   16 dc f9 fc  c7 93 08 75  58 16 57 71  69 96 66 b7
|   a9 81 7f f7  37 4d 7c 41  38 62 a6 39  00 81 ca 3d
|   1d fc f7 b5  08 38 d4 34  70 22 6c 21  d2 5b 20 a1
|   d2 ba 2a d1  89 f3 20 79  ce ac 1e c2  ec 7d ae 76
|   94 40 39 a0  3d a6 6a 81  e2 92 09 be  18 4f a0 1e
|   5c ed ea 7c  7d 7b 3a 21  3e 15 0d 53  5d 17 6a be
|   1b c5 70 ab  34 47 bc 09  14 7c aa 91  9c 8f 81 dc
|   1e f9 87 cd  6a ec fa f3  a5 9e 37 bc  ac 3d fd e1
|   32 8e e8 b3  fe d3 8b f4  7b 50 34 13  33 7a 93 ea
|   e9 3c 0e 8b  29 00 00 14  20 98 9d 37  a8 14 a6 4d
|   8f f0 7c 08  d3 20 e9 e3  29 00 00 1c  00 00 40 04
|   0b 20 60 e6  6e f9 4d 29  d9 06 93 6c  d5 6c 67 a8
|   7b ce 16 d5  26 00 00 1c  00 00 40 05  76 47 fe 79
|   df 56 95 f2  3a e3 71 d3  0d 55 fa 61  fe 77 7a ca
|   2b 00 00 19  04 86 cb 59  12 06 07 df  3f 00 36 b9
|   64 c6 c5 14  1f 3a ed cd  aa 00 00 00  10 4f 45 70
|   6c 75 74 6f  75 6e 69 74  30
1: input from peerB-R1a.pcap
|   =========== input from pcap file peerB-R1a.pcap ========
| *received 457 bytes from fe80::ec68:7cff:fe0c:9aa4:500 on eth0 (port=500)
|   8d 0e 0f 10  11 12 13 14  78 5b 90 fe  dd d1 18 2d
|   21 20 22 20  00 00 00 00  00 00 01 c9  22 00 00 30
|   00 00 00 2c  01 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  03 00 00 0c  03 00 00 08
|   02 00 00 05  00 00 00 08  04 00 00 0e  28 00 01 08
|   00 0e 00 00  bd 48 18 9c  9e 03 70 f2  55 ce 45 22
|   9f c7 c9 48  43 a3 e2 64  b5 5d 43 38  c8 fe f1 d3
|   06 43 f0 0a  e8 6d 61 8c  60 78 d9 98  d3 1b 3b 5e
|   f5 a6 e8 2f  ef 56 ac b4  33 bd 1e 62  b2 3e 0b 17
|   af 6c b8 31  08 d7 19 5a  7b c4 54 c2  13 47 98 c2
|   cc d2 16 29  75 6c 03 fb  1e 9c 9d 21  0c a1 e6 c2
|   f3 f2 49 2c  f6 06 73 c1  96 1e ce 58  81 01 1c cb
|   16 dc f9 fc  c7 93 08 75  58 16 57 71  69 96 66 b7
|   a9 81 7f f7  37 4d 7c 41  38 62 a6 39  00 81 ca 3d
|   1d fc f7 b5  08 38 d4 34  70 22 6c 21  d2 5b 20 a1
|   d2 ba 2a d1  89 f3 20 79  ce ac 1e c2  ec 7d ae 76
|   94 40 39 a0  3d a6 6a 81  e2 92 09 be  18 4f a0 1e
|   5c ed ea 7c  7d 7b 3a 21  3e 15 0d 53  5d 17 6a be
|   1b c5 70 ab  34 47 bc 09  14 7c aa 91  9c 8f 81 dc
|   1e f9 87 cd  6a ec fa f3  a5 9e 37 bc  ac 3d fd e1
|   32 8e e8 b3  fe d3 8b f4  7b 50 34 13  33 7a 93 ea
|   e9 3c 0e 8b  29 00 00 14  20 98 9d 37  a8 14 a6 4d
|   8f f0 7c 08  d3 20 e9 e3  29 00 00 1c  00 00 40 04
|   67 1e 35 d8  ca 06 d5 88  dd 32 62 02  d3 1d 16 89
|   2b 2a e7 59  26 00 00 1c  00 00 40 05  54 b7 34 30
|   9a 69 ed db  c7 ba 43 77  83 8e 3c b6  fc e1 04 cf
|   2b 00 00 19  04 86 cb 59  12 06 07 df  3f 00 36 b9
|   64 c6 c5 14  1f 3a ed cd  aa 00 00 00  10 4f 45 70
|   6c 75 74 6f  75 6e 69 74  30
|  processing version=2.0 packet with exchange type=ISAKMP_v2_SA_INIT (34), msgid: 00000000
| I am the IKE SA Initiator
| I am this exchange's Initiator
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  78 5b 90 fe  dd d1 18 2d
| state hash entry 6
| v2 state object not found
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  78 5b 90 fe  dd d1 18 2d
| state hash entry 6
| v2 state object not found
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| v2 peer and cookies match on #1
| v2 state object #1 (peerA--peerB) found, in STATE_PARENT_I1
| removing state object #1
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  78 5b 90 fe  dd d1 18 2d
| state hash entry 6
| inserting state object #1 bucket: 6
| state found and its state is:STATE_PARENT_I1 msgid: 00000
| now proceed with state specific processing using state #0 initiator-V2_init
| requested CA keyID  86 cb 59 12  06 07 df 3f  00 36 b9 64  c6 c5 14 1f
|   3a ed cd aa
| selected proposal 1 encr=aes_cbc[128] integ=hmac_sha2_256_128 prf=prf-hmac-sha2-256 modp=OAKLEY_GROUP_MODP2048
| #1 complete v2 state transition with STF_SUSPEND
| duplicating state object #1
| creating state object #3 at Z
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  78 5b 90 fe  dd d1 18 2d
| state hash entry 6
| inserting state object #3 bucket: 6
| IKEv2 thinking whether to send my certificate:
|  my policy has  RSASIG, the policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|  sendcert: CERT_ALWAYSSEND and I did get a certificate request
|  so send cert.
| Thinking about sending a certificate request (CERTREQ)
|   my policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   my next payload will be a certificate request
| going to send a certreq
| have CA 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA', send CERTREQ with CA's Key ID
|  payload after AUTH will be ISAKMP_NEXT_v2SA
| #3 complete v2 state transition with STF_OK
./peerA-R3S transition from state STATE_PARENT_I1 to state STATE_PARENT_I2
| v2_state_transition: st is #3; pst is #1; transition_st is #1
./peerA-R3S STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 oursig=fakesig1 theirsig= cipher=aes_128 integ=sha256_128 prf=prf-hmac-sha2-256 group=modp2048} (msgid: 00000000/4294967295)
| sending reply packet to fe80::ec68:7cff:fe0c:9aa4:500 (from port 500)
sending 1616 bytes for STATE_PARENT_I1 through eth0:500 [fe80::8054:3eff:fe9a:d3f4:500] to fe80::ec68:7cff:fe0c:9aa4:500 (using #3)
|   8d 0e 0f 10  11 12 13 14  78 5b 90 fe  dd d1 18 2d
|   2e 20 23 08  00 00 00 01  00 00 06 50  23 00 06 34
|   8d 0e 0f 10  11 12 13 14  15 16 17 18  19 1a 1b 1c
|   67 a7 d9 8f  d5 3a c4 a5  01 f5 8f f2  15 07 1f 4b
|   4b f9 31 1a  0a d1 98 77  39 d8 e6 6d  4e b6 cb 05
|   9a 21 28 8b  3c a5 27 1c  a4 52 f8 32  c0 bd b4 19
|   72 57 22 a8  3d 5a bd d9  19 77 65 ec  85 a5 e7 c4
|   a5 f5 fd 45  ec 9a 1e db  a2 67 00 a6  fb 3c 32 4e
|   c2 2e 2a 35  ef 5a 27 6a  08 93 83 41  f7 c7 ed 00
|   ad f0 94 e3  cd 5c aa 28  6b fe c6 5c  f6 f7 39 9e
|   c9 fc bf eb  69 cc 79 6e  2a c8 49 ca  4c 82 5e 96
|   6a 75 9e dc  a7 9a 9b ab  22 f8 06 f4  ec 9a 08 36
|   80 6f ce be  29 f0 0a 77  6f 38 37 38  ee 70 d2 0f
|   a1 93 e2 22  ef 6a 89 e1  6f 02 9f 0a  5d b3 6a b1
|   37 e7 ab 04  fc e3 4c 46  9b f7 3b ce  d7 8e 2f c9
|   54 a0 dc 41  96 75 65 fc  cb 11 3d 65  ff 49 af 9a
|   ab 04 33 91  94 d0 2f 70  53 8d 84 ad  a5 3e 54 82
|   b8 6f 36 98  b7 81 5c 04  09 6f a8 6a  8f 6e 2c 52
|   be 94 ec e7  39 26 60 81  78 9d 17 13  f4 6a c0 d6
|   13 65 e3 22  a5 ff 5a 0f  00 82 12 ae  7f cf eb 83
|   32 84 0a 50  1e 12 db bb  72 0b 14 27  8a b2 f8 82
|   6e f4 ec 03  e7 bc 7c bb  81 b6 a8 7a  34 bd 7a 9e
|   47 27 36 1b  dd 77 47 4f  e9 49 c7 d2  46 37 9d 4b
|   f0 07 45 3e  1b 38 58 47  29 70 ac 1b  44 8d 94 f2
|   8b 5f 7a 36  3e fc af 89  81 f8 ea ff  0c 77 ac ef
|   89 c8 5b 3f  37 93 43 5a  51 55 ee 6d  2b 06 6c 9f
|   3c 0c c7 12  a2 85 40 3c  3b 58 ad 5a  56 5a 49 9d
|   57 d2 00 91  16 7d 63 c5  e0 72 0a d1  dc 78 19 3e
|   86 b0 ec e5  fe 42 49 15  66 62 d0 4d  65 5f b8 fc
|   e6 59 63 54  f9 0d 0c de  0b 5b 0c 0e  c1 8b 00 24
|   e3 a6 ba 95  ae 44 ac 4d  8b c3 70 a1  4c f3 c3 0a
|   4c 63 13 12  62 56 94 59  4c 81 dc 2f  3a 69 b0 01
|   1c 7d 33 b2  e3 c6 80 39  59 09 85 d6  6e ae 3c d5
|   24 14 d8 8a  39 7c df c8  cb 05 b2 05  a9 23 a9 c0
|   ac 47 82 29  a6 2d 3f e5  e1 24 05 f3  d6 75 f0 f5
|   b8 4a 3c 82  3e cd 28 e9  61 c0 5e 79  e5 4b 20 5c
|   41 b1 ff aa  19 41 23 56  7b 87 a6 4a  ef 5a e8 3e
|   bf 70 c1 52  da d7 a4 55  b6 c8 f5 8b  e8 ec 2d e0
|   28 f4 dc 29  c8 23 bc 88  f6 c0 44 d7  cf 5c 11 67
|   ff 0e 99 45  6b a7 98 06  86 e3 c3 8c  58 2d 07 29
|   b6 16 61 6d  ca ab 53 fa  76 c6 70 a5  c7 1e 58 22
|   07 80 86 6e  43 43 59 a3  fd 6a 35 31  b5 d2 be 9f
|   3d 0c 96 1c  fd ad dd b2  3c b0 b2 6d  d0 1e 05 64
|   e1 9c 71 d6  4c 33 33 9c  84 f3 73 92  89 67 34 02
|   94 b8 78 3e  73 e1 86 9e  d1 1b 62 00  1b 51 20 75
|   1b 04 26 ed  9e 19 40 38  85 c9 6c f0  f7 0c c5 96
|   2b 23 79 2a  c9 1b 22 dd  c4 a4 fa 86  f0 4a 1e fb
|   18 f0 db c3  c0 e3 52 01  82 cb 9d 05  b5 98 53 8d
|   6e 7c f1 03  e2 aa 63 5e  01 e0 d8 a1  0d 57 e3 22
|   b6 84 5c f3  c4 f0 d9 08  6e 61 05 dc  4c e1 51 7b
|   74 fa 5f 2b  8c 31 4a cb  ca f3 46 4c  d9 81 4a c9
|   16 c9 bc fa  68 27 a1 b7  a1 74 57 53  49 54 19 ed
|   09 e7 24 77  d2 94 24 40  a0 de 68 ab  bd d5 9e 3a
|   22 31 e7 18  a4 c9 fe c3  92 dd 0f 00  2a 5d e5 ec
|   a7 f0 6e 84  25 f2 d5 8e  95 fa a3 27  5c ba 34 4d
|   b1 47 e1 00  3d fa 08 ec  e8 64 50 ac  22 e0 f1 47
|   e7 42 be fd  03 c5 bf db  06 c2 dd 8b  cd 9e 98 a6
|   bd 34 e8 3e  61 cd 4b e1  ba 8d 23 2b  94 f4 f6 53
|   31 7e a0 70  39 0a 87 c1  c2 99 07 69  52 05 04 a9
|   ab a0 03 f9  6c cc 76 4c  60 67 86 53  f7 7e 3c 1e
|   c5 88 ce 51  04 ec c9 da  c9 98 cd db  de 36 13 c5
|   dc c7 d1 ef  76 27 b1 dc  72 e0 b6 fb  c6 b0 36 d4
|   c5 60 c6 84  f6 16 77 66  4d f9 77 a0  3e 41 28 74
|   e3 76 49 1b  47 20 c7 e5  73 8c 74 3f  78 5d 3a bf
|   99 16 81 56  2c 15 62 8a  f4 5b 47 3c  e6 e5 37 27
|   53 86 ee 03  42 5d 31 d1  21 69 13 cc  cb eb 7d bf
|   51 3a ed d2  19 96 5a 98  79 c1 82 59  6e 1f 9d 9b
|   df ec f3 5b  50 ea 49 43  29 90 74 4f  3e 78 d7 94
|   12 93 e2 56  cc 5b ac 81  8c cf 79 cb  dd 6d 47 de
|   50 16 22 53  c1 86 46 bc  70 31 8a 53  99 7d 94 b1
|   6d 87 f2 98  be b7 a1 f8  09 c6 65 f4  b9 0c b3 dc
|   b1 41 06 b3  b7 7f 21 f2  64 00 d4 2a  98 6c b9 70
|   e2 c7 b3 22  25 87 80 32  40 fe 91 a7  90 7b ad 22
|   16 cb 39 b4  c1 5a 4c 08  b7 8b d0 9c  21 73 26 31
|   02 3b 21 99  30 76 f8 df  04 a3 4c 3d  fd 9f cf e3
|   fa 36 8c 41  36 47 5b db  95 d7 1c 8a  f2 08 0c b3
|   91 2f 82 bc  dd 94 db ee  12 dd 88 25  6d db f7 ea
|   85 6e 39 83  a0 e8 7d c3  1f c3 2f 4d  f5 5f 41 d8
|   28 54 38 14  00 f0 b2 15  2e 3d 53 ee  3a e7 aa 8b
|   28 b9 8e b4  57 8d 0b 9a  82 82 1d e7  cc 54 07 79
|   f6 db bb 0d  69 88 d7 3b  6b a8 af 52  67 af 7b a9
|   c0 6f bb 69  9b df d1 ae  22 f8 b7 ac  b0 aa 61 54
|   0c 2e 9e c8  fa dc 4e 38  a3 e3 ea 63  45 e3 13 84
|   5f 9e 2b 43  56 f0 ec d6  4d a1 38 8d  39 49 45 a7
|   11 85 f5 06  f2 c6 ce d1  2b 5c 6f 75  06 e4 62 5c
|   24 49 af c2  c7 d9 0e 93  41 37 2c d2  65 c7 e8 2c
|   76 64 62 de  39 b4 3e fa  41 df 8d 7a  fc 8f b1 b2
|   4b db f6 9d  f4 43 34 8a  3e ca ac 70  7d 22 e2 d9
|   0b dd 46 cb  aa 4e 45 1c  39 2b a1 6d  1e 4b 78 67
|   be 13 f1 04  56 03 80 0e  60 4e 32 d8  c4 8b 45 f7
|   1f b8 1a bc  65 2b 36 bf  19 ce 3f b1  42 a2 1b 27
|   08 21 a0 96  b5 5a 89 2b  eb e4 9b 8d  61 16 05 bc
|   53 40 29 50  1f 51 06 d3  48 04 e5 1e  31 a4 a9 78
|   78 2a 50 52  da cb 34 01  72 ed f3 57  9b db a2 f9
|   01 23 f5 b4  be 80 e6 c8  a5 e9 21 aa  cc ff 77 50
|   ec 05 f8 c7  51 06 89 d7  a6 36 4c 79  c3 06 11 3d
|   86 81 99 84  5e 31 32 58  cf b9 8b 0e  76 02 29 9a
|   f3 3a 70 c3  e8 49 cc 3b  6c d2 fe 07  ed 65 68 4c
|   1f 8d d5 17  c3 59 21 4d  fe 3f 9b 76  4c b2 19 b5
|   fd 56 0f 7b  3a 1a 85 07  42 ad 13 a6  de e7 11 29
|   fd a8 f6 ba  c4 97 8a 12  d4 64 3c 0a  eb 93 1c 99
2: input from peerB-I2b.pcap
|   =========== input from pcap file peerB-I2b.pcap ========
| *received 1616 bytes from fe80::ec68:7cff:fe0c:9aa4:500 on eth0 (port=500)
|   97 18 19 1a  1b 1c 1d 1e  97 03 67 ba  2d 8b a4 1d
|   2e 20 23 08  00 00 00 01  00 00 06 50  23 00 06 34
|   97 18 19 1a  1b 1c 1d 1e  1f 20 21 22  23 24 25 26
|   80 2d 7a 14  99 fe 16 66  77 d4 cc 64  d4 06 40 58
|   66 0d 93 04  8b da af 6b  a0 4f 10 03  6c be 1f a1
|   7b f5 3a b3  87 be 5a b1  7d 4d 6f 67  b5 92 53 bd
|   57 cb 48 81  71 63 0d a3  cf 35 10 f4  5d b2 0c 62
|   68 13 69 55  cd 46 a7 9a  e3 e1 da 1f  29 4a a7 1c
|   88 f9 7d 7c  7e d8 d4 bb  3c cf ed 92  4c 03 3c 0d
|   8d d9 19 b9  18 00 c5 9f  22 8e 0e 9c  55 f1 48 a0
|   88 aa 64 86  0a fd 7d 6d  1b 8a e2 e5  72 34 1e 0e
|   d9 f0 9f 33  a5 4a de 19  b3 89 57 6b  50 0a 92 cf
|   aa 37 70 08  ca 53 25 ad  eb 05 8a 98  0c 5d 70 08
|   47 f6 bc ad  29 4b e1 bb  f8 95 c5 18  a1 ef 46 5e
|   2e 5a dc 0f  30 44 55 1f  10 00 0a ba  46 51 1c 47
|   ad 54 02 96  99 b3 1e 4a  79 1f 62 2f  05 5a 7a 86
|   31 4d ac 3d  b2 5a 28 75  76 90 cb 7a  dd 3b 6c 22
|   bc 67 f1 67  2a a4 7c 0f  61 d3 d5 07  1a 4e 24 61
|   2c 79 79 09  ff 08 b5 4a  97 fb 78 21  b9 30 2d fd
|   88 4b f1 41  46 cf 37 40  5b 44 e5 5b  16 6a d1 5d
|   69 a3 4c 26  4e f1 6a 12  2f c5 68 3b  a2 bb c1 c0
|   be 02 25 fb  a5 0e 7f 93  c8 53 5e 5d  55 d9 a1 a0
|   2a 6a 1e c1  10 45 12 2c  fe 97 2a d9  3d 3c 32 09
|   f8 a7 9e e2  8b 5f e5 e6  de 25 df 89  52 75 50 07
|   11 e0 be fd  24 e8 d9 95  e7 1c f1 4f  32 eb 8d 01
|   14 8b ef 37  09 ae d0 1f  39 71 38 ee  37 1f 78 76
|   72 82 3e d1  48 52 45 1c  0a ac ad dd  31 52 56 1c
|   cc 3d 62 48  fe 3c 53 7f  8d 27 0a a3  97 d0 a5 68
|   b6 82 62 e6  98 2f e3 ec  5f de be 4c  59 8d f7 f9
|   18 63 ae c7  10 10 1f ad  8a 4f e9 58  d8 e1 59 9c
|   df 7b ee 77  82 8e 97 a1  d5 52 c7 9d  8e d8 7a ba
|   be 1a 7f c4  d5 8c 39 21  69 79 d6 73  04 37 eb 96
|   22 39 60 5e  5c 89 32 b4  b9 3b 97 cc  93 a1 c0 bf
|   ae df e2 ae  92 10 dc a6  e9 55 79 a3  5c 13 b5 76
|   2a 8c 2b c3  2a 28 1c 66  32 64 8e ae  ba b5 82 db
|   a9 57 0c e7  01 9f cd 8a  70 d1 6b 97  bb f7 a6 85
|   89 dd c0 03  1a a9 76 84  80 67 99 4c  a4 87 56 ca
|   f1 f6 82 0b  82 02 11 25  bb fe e1 13  89 0e 0d d2
|   86 86 2e aa  d5 09 a3 3d  ab 69 3b 52  d2 1b b7 f5
|   3e ae af cd  5d 9a 2a 11  02 72 0e ad  ad b8 c4 cd
|   03 35 c2 da  1c 52 3f 38  80 0b 4e eb  93 55 43 ad
|   29 cc 59 92  72 63 3f 73  27 af 86 16  ac 92 bb 75
|   52 30 de 9b  ef 62 41 60  93 5a 82 2b  c5 53 cb ea
|   dd b2 e9 78  da 1e b6 6b  1b b3 b2 ea  b6 a6 12 e3
|   52 36 1c 7e  7c 03 5c b2  c8 16 57 4d  ab 9e af d1
|   ba 52 f4 ab  bb 82 e5 95  2b 29 3f 28  20 51 00 7b
|   6e 64 35 70  99 83 f7 33  4f 9e 61 89  32 75 79 ba
|   ec 7a b2 9e  cd d8 b3 17  cb e9 25 b7  47 3b 0f 02
|   0b e4 23 62  58 1d cc 1f  0f 90 da 46  54 5f d6 d0
|   8a 69 8b fc  d9 bb b0 c2  eb 10 11 dd  c4 76 13 a0
|   79 e8 69 e3  93 9a 0f 94  2d ce 25 fe  e4 29 77 cf
|   1b c8 32 1d  25 2c f5 03  bb 2a 7f 71  49 4c ce bb
|   cb 7d 0a ad  ea 1b 05 bf  2c 71 49 10  c4 37 12 77
|   e8 6c 01 3b  cf 08 ce 24  eb c5 bd db  ea 9a 49 5f
|   c4 19 d7 7d  68 3f d4 33  fb 8e 14 99  ed e2 d8 f0
|   d3 78 cc bc  e9 95 4b 52  48 42 ce 1f  6e 84 a0 cb
|   7f b3 8e fe  49 6c ef 90  a3 3f d7 7c  5c 9a 5c bd
|   76 aa a1 8f  d7 92 d8 c8  fa d5 a2 5e  7d d5 df 8a
|   d4 e2 4c 70  a4 3d 4b 51  7f af e9 e7  5d 66 7b ca
|   92 50 a5 e0  47 30 38 93  40 64 08 1e  ff 7e 5e 60
|   96 20 ef d7  aa 23 8d d9  d9 bd 1e be  70 31 33 71
|   b3 d7 b1 25  27 92 79 9f  67 46 91 1d  40 42 85 31
|   d8 c3 d5 b8  89 94 38 38  89 95 49 16  7a d2 3d b2
|   a4 c4 1a 84  fe 30 66 94  a4 06 eb 93  5d 40 be 58
|   5a 89 a4 23  2a be e3 df  c8 3f d0 70  de ce 40 74
|   f4 a6 59 cf  8b aa 9a aa  d3 1e 52 aa  84 c0 7a 25
|   87 02 8f ed  db 1d d3 2e  ed 07 38 88  fc ea 70 6b
|   d2 11 40 1f  97 f9 19 d3  36 2b b6 c0  1b bb a1 a7
|   99 50 98 ba  56 72 1d 59  f5 ac 2c 1f  7d 9f bf 21
|   5b 6f c3 2d  e6 18 db e2  94 72 d0 69  8a 68 c9 28
|   f0 f0 7c 0d  c9 26 e0 c3  29 f7 8f 07  5d f7 5a 33
|   5c 44 c3 56  32 95 5c d0  34 aa 6b 0f  81 ab 9b 44
|   25 3b 30 2e  c6 66 e0 98  32 be 94 17  95 37 12 53
|   1b d3 2b 0f  eb c5 9e 5e  b7 a3 dd b0  4e d8 ca a5
|   bb c4 43 d5  e0 63 67 b6  41 d5 b4 a5  dd 84 6b ca
|   bd f1 ca 8c  b7 cd fa c6  a7 32 56 4f  d8 12 39 dd
|   01 16 1c 91  26 f3 cc b2  5b 96 ef 41  80 3a e7 b0
|   2d 21 dd 76  5d 28 72 66  6d 4b 47 e8  40 bc 4e de
|   a3 cf 6a 3c  03 ce 40 b3  24 8f 22 3a  66 41 5d e9
|   4e 6b f6 06  9e 4a 49 cd  71 cd f1 89  8c e6 f0 4e
|   fd 1e b4 fd  cd 24 a2 29  f9 82 50 2f  e3 9b 24 e5
|   df c2 d5 62  57 d5 21 b0  4c f8 5b f3  ae d7 4b 66
|   24 ab 42 f5  f0 b6 22 13  cc a5 fd 3b  ca 61 b6 12
|   d5 34 c4 d0  5d 6d d3 39  89 41 64 92  d0 78 e1 9d
|   80 9f 0e d2  95 4c f2 68  eb c1 1f 72  17 88 25 63
|   88 56 68 c9  cb 53 25 15  fc ce 07 86  a8 2c ea a4
|   66 21 b2 b4  04 64 52 b5  c6 1f cb 03  32 df 5b 97
|   31 6a 28 8c  75 dc 53 3a  a9 1b c4 23  8a b3 35 9f
|   77 9a 34 96  07 c4 24 4a  d5 09 1b da  1e de 20 b7
|   d4 9e c7 1a  86 bb a3 f1  40 fa 10 1b  a5 cd be 2f
|   61 9f 01 0c  ef 1c af 8d  17 c8 ef 84  59 3d 34 14
|   8c 9b cb 74  05 41 0a 01  52 1b 9a a1  f8 ce bd 7c
|   d0 cd 3c 01  ba e8 ed b4  c8 0f 72 67  ff a1 55 fb
|   6f c7 f6 3d  ac 6a ac 86  4e 62 fb 1b  43 55 bb f2
|   a2 80 ae ee  73 45 f6 2a  94 6e 37 67  ac e1 b3 81
|   db 25 d0 b4  e4 08 28 05  93 1e 35 07  c6 02 c9 15
|   e5 1e cd d0  db 2b 5e 1e  d1 cb 9a 76  ad 82 d1 5b
|   e3 8e 9e 82  eb d4 65 2b  ac d5 e8 6f  3f 3d 83 70
|   ca c6 a7 24  83 0f f8 0f  9e 31 15 5a  46 8c 3b 4c
|   d9 5c f5 bb  42 d7 de 8c  8e a8 9a 83  5b 8a 85 22
|   f8 82 26 d1  ce 5d 80 b4  01 ac 5b 2e  47 bf 76 ed
|  processing version=2.0 packet with exchange type=ISAKMP_v2_AUTH (35), msgid: 00000001
| I am the IKE SA Responder
| I am this exchange's Responder
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| v2 state object not found
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| v2 peer and cookies match on #2
| v2 state object #2 (peerA--peerB) found, in STATE_PARENT_R1
| state found and its state is:STATE_PARENT_R1 msgid: 00001
| now proceed with state specific processing using state #4 responder-auth-process
| #2 complete v2 state transition with STF_SUSPEND
./peerA-R3S IKEv2 mode peer ID is ID_DER_ASN1_DN: 'C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org'
./peerA-R3S v2_CERT received on reponder, attempting to validate
./peerA-R3S no crl from issuer "C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA" found (strict=no)
| reached self-signed root ca
./peerA-R3S 0: validated X509 certificate: 'C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org', added to trusted database
| requested CA keyID  86 cb 59 12  06 07 df 3f  00 36 b9 64  c6 c5 14 1f
|   3a ed cd aa
| ikev2 verify required CA is 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|
| List of X.509 End Certificates:
|
| NOW, count: 1
|        subject: 'C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org'
|        issuer:  'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|        serial:   0c
|        pubkey:   2048 RSA Key AwEAAeOoT
|        validity: not before Aug 07 01:03:04 UTC 2024 ok
|                  not after  Nov 15 01:03:04 UTC 2026 ok
|        subjkey:  c2:64:69:e8:dc:88:e3:23:58:47:07:86:4b:5e:d4:b3:ea:bc:a7:10
|        authkey:  86:cb:59:12:06:07:df:3f:00:36:b9:64:c6:c5:14:1f:3a:ed:cd:aa
| checking alg=1 == 1, keyid=carol@openswan.org same_id=0
| checking alg=1 == 1, keyid=dave@openswan.org same_id=0
| checking alg=1 == 1, keyid=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org same_id=0
| checking alg=1 == 1, keyid=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org same_id=1
| key issuer CA is 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
| PARENT SA now authenticated, building child and reply
| IKEv2 thinking whether to send my certificate:
|  my policy has  RSASIG, the policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|  sendcert: CERT_ALWAYSSEND and I did get a certificate request
|  so send cert.
| Thinking about sending a certificate request (CERTREQ)
|   my policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   my next payload will not be a certificate request
| I did not send a certificate request (CERTREQ) because
|   already received a CERT from peer
./peerA-R3S received CHILD SA proposal(s) will be processed
| ei->port 0  tsi[tsi_ni].startport 0  tsi[tsi_ni].endport 65535
|     evaluate_connection_port_fit tsi_n[1], best=-1
|    tsi[0] 0-65535: exact port match with 0.  fitness 65536
|       evaluating_connection_port_fit tsi_n[0], range_i=65536 best=-1
|    tsr[0] 0-65535: exact port match with 0.  fitness 65536
|       evaluating_connection_port_fit tsi_n[0] tsr_n[0], range=65536/65536 best=-1
|     best ports fit so far: tsi[0] fitrange_i 65536, tsr[0] fitrange_r 65536, matchiness 131072
|     port_fitness 131072
| duplicating state object #2
| creating state object #4 at Z
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| inserting state object #4 bucket: 2
| #4 complete v2 state transition with STF_OK
./peerA-R3S transition from state STATE_PARENT_R1 to state STATE_PARENT_R2
| v2_state_transition: st is #4; pst is #2; transition_st is #2
./peerA-R3S STATE_PARENT_R2: received v2I2, PARENT SA established {auth=IKEv2 oursig=fakesig2 theirsig=fc1 cipher=aes_128 integ=sha256_128 prf=prf-hmac-sha2-256 group=modp2048} (msgid: 00000001/00000001)
./peerA-R3S negotiated tunnel [::,ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff proto:0 port:0-65535] -> [::,ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff proto:0 port:0-65535]
./peerA-R3S STATE_CHILD_C1_KEYED: CHILD SA established tunnel mode {ESP=>0x12345678 <0x34567812 xfrm=aes_cbc_128-hmac_sha2_256_128 NATOA=none NATD=none DPD=none IF_id=000011d7}
| sending reply packet to fe80::ec68:7cff:fe0c:9aa4:500 (from port 500)
sending 1552 bytes for STATE_PARENT_R1 through eth0:500 [fe80::8054:3eff:fe9a:d3f4:500] to fe80::ec68:7cff:fe0c:9aa4:500 (using #4)
|   97 18 19 1a  1b 1c 1d 1e  97 03 67 ba  2d 8b a4 1d
|   2e 20 23 20  00 00 00 01  00 00 06 10  24 00 05 f4
|   8d 0e 0f 10  11 12 13 14  15 16 17 18  19 1a 1b 1c
|   ae e3 fe 75  ce 32 e4 53  47 b1 a6 cc  42 b7 95 66
|   71 a7 32 f7  c8 ad af bf  d1 16 fe 5a  24 5b 25 33
|   8d 5d 24 30  30 0b 2c e2  f2 47 95 d1  9a 99 30 d5
|   52 f7 3f d0  a5 5f fc 41  15 d4 a2 7a  4c c4 f0 57
|   ed 0d f2 06  94 7f 77 90  0c 68 73 d1  b4 0f ee 9d
|   86 e9 78 89  27 7e 0b c3  fe 63 7e 1b  a7 49 fb 36
|   7e 2d 19 b3  60 6c 60 ec  5c c8 8c 7c  bc 59 d6 c4
|   88 71 e3 28  2a 08 0b 68  8a 9d 6b d7  ed 17 4e 1a
|   52 0f 49 50  1f 89 af 0c  30 88 21 1f  b4 c3 b3 98
|   f4 ae b0 c9  26 ed a6 67  7d f4 ff c1  0a 7b e6 b6
|   a8 d9 96 f2  83 59 72 d6  7d 68 71 5a  cc 5b 98 81
|   15 90 55 34  3c 6b 80 e0  53 1a 51 a0  cd 6c 73 26
|   eb 8a 14 f4  54 04 8f a6  ae e3 f4 61  13 39 ed 38
|   c7 48 b7 d6  29 07 eb 6a  f3 e8 75 e8  5e 4f ad a2
|   6a ab f1 5f  05 cf 95 bc  ad 7d 3a a6  d7 ed 85 37
|   fa c8 a7 45  3e 77 3b f8  22 10 b3 2c  f6 1e b4 b6
|   19 21 8e 33  7e d6 ee fa  9e 3b 64 bd  df 2b bd ce
|   b8 79 61 cb  c4 8c 5b 41  97 0a ef e1  43 04 46 8f
|   3f 25 6b f0  ce 6e 10 c7  30 5e ea 00  f2 b8 b8 e8
|   04 59 f9 6c  ee a5 1b 1d  84 a0 6f a0  c6 c6 48 fa
|   ae 13 32 76  e2 23 d9 a0  3b aa a6 4c  20 de 01 6a
|   95 8d 3e 6b  1a 58 22 00  a4 22 a7 22  f0 75 97 cd
|   3d a5 03 08  7a f3 95 3a  8a 97 f9 e2  2a 3c 1c bf
|   f9 7c cc fd  f8 cb 00 02  5c 2e 78 5e  90 39 3b 34
|   ac 9d 71 2e  b9 56 21 7c  a5 c0 58 06  ae 76 87 7a
|   34 2e 59 5b  b8 fc f0 da  3b 22 07 0e  f3 c6 75 af
|   8b b8 bd 52  84 fa 19 1b  e4 4f 6b d9  5a fe f6 d0
|   88 85 df 0b  d9 40 49 a9  15 71 2e 8d  40 62 b9 ee
|   72 59 c1 67  23 f0 39 06  1b 06 3d 21  ee 35 34 46
|   8f f5 cf 1f  3a c8 95 b8  60 fa 0b 05  c6 82 f9 be
|   44 37 95 a9  fe 1a b7 d5  dc 32 fe a5  4a 75 c5 5a
|   2a b2 d0 0d  9a 1e b9 c6  fa a0 ee 6d  f8 91 07 7c
|   85 c1 06 58  e0 a6 c2 23  f2 04 a2 ca  09 4d 81 52
|   2a 42 7c 7d  61 e6 0a 3d  08 1d e2 25  2b ba c8 2b
|   c9 ea e2 ba  f6 06 2d 13  4d b5 d1 1e  e1 f1 30 a5
|   82 ec 9b 02  66 46 5d 9e  63 e5 dc 55  3a 2f 0f c0
|   30 a1 62 33  5d 22 86 f9  a1 ee fe b7  5f 7f 22 44
|   9e 1a d1 06  82 ee 05 4e  5d 68 5e e6  be a7 71 01
|   ae 5f 14 3a  53 ae 1b 6d  65 40 a8 a1  c5 3e 6c bd
|   59 9f 02 45  c2 6d 2a 9d  13 dd 81 6c  af 58 51 4a
|   b7 18 f6 ab  54 91 65 87  22 a9 3f e2  62 c6 23 43
|   cd 5d 8e 86  a5 53 a1 87  fa 84 13 28  54 0d 88 6d
|   54 e4 56 d4  11 65 4d 91  8e 67 32 56  25 64 04 32
|   89 7a 66 a0  f1 c4 39 93  89 32 d7 15  5d 98 74 31
|   e6 08 c1 ff  2a aa c1 a7  98 13 0b 6a  8e e7 70 39
|   a4 b7 95 97  5f dd 59 81  cc 28 f9 22  f7 b5 20 92
|   27 f2 f1 86  35 6a fa e2  1b 69 3a 02  e5 a5 e7 46
|   44 51 45 3c  8a 26 63 47  57 58 a3 8b  c5 ca 1d 78
|   28 74 58 c0  73 1e e4 82  40 3a d0 ad  76 91 14 d2
|   a3 4f 7a dc  c4 45 7c 89  2d 90 d0 8b  42 b1 51 df
|   17 2d fb db  36 2f 22 9f  88 31 94 c5  fc cc 94 6c
|   ac 6d 00 37  70 70 6c 0f  7f c8 8c b9  05 cb 93 2b
|   6c c2 bf a7  fa 05 d6 75  8e 6f 50 07  cc ec d4 91
|   f2 bc 3b 54  4e 1f 5c 5d  fb d5 e6 96  b9 a9 1b a8
|   79 3b e3 c2  66 4e 7f 22  9a c7 98 34  f5 21 12 bf
|   0c 13 17 cf  a7 a8 69 e9  32 27 02 37  07 8b 20 0b
|   9a 64 9e d2  9d 85 a3 a1  dc 8c 59 d9  8f 88 06 60
|   6e c5 c7 96  ad 2b c7 95  97 52 7c 64  55 28 2a 36
|   39 88 71 f9  db ba 3d d7  0e cb 76 ae  32 ab ff 41
|   0e db 6e 97  ff 8e aa 05  22 91 e4 7f  af e6 3c b5
|   91 6d 59 5a  85 93 a5 39  78 00 11 40  ac fc a1 4b
|   bb 17 e8 bc  04 0e ab dd  09 3c 97 d2  d2 e7 b6 4c
|   1e 98 e9 64  09 6d 7e 91  e9 23 8f ee  d8 8c be 46
|   47 cb 05 ba  d5 79 2c b4  3d 7d 18 12  66 e3 01 96
|   4e 4e 6b 4a  f5 28 88 e0  f8 9d d8 dc  51 1b be 84
|   56 64 05 ab  f8 93 8f 00  ba f5 e6 21  fe 9a d5 a6
|   e2 42 86 82  76 fc b0 55  b7 58 2d 80  6b 7b 74 d8
|   5f 2c 13 ef  4f 6e 6c fd  28 38 c5 e4  11 e1 1c 51
|   6e c4 ac cc  13 18 3e bc  58 59 9c ae  43 46 5d f0
|   d1 3f 3e 7b  d2 a3 19 c2  80 27 ef bc  7a b4 4a 16
|   c5 be 5b fa  eb 61 f6 0a  89 9d 72 79  f1 53 1a 60
|   39 7f fe f8  8e 45 5b c8  f6 dc 89 29  f5 2e cb 84
|   9d ae 9c e9  11 05 63 05  ec d4 ee 60  8d 0f 06 7d
|   4b b9 4d df  e6 72 36 ee  c5 c1 e4 59  c4 e8 0e cf
|   69 6a c0 13  1a b1 67 c5  51 3d 42 42  2b 0c 91 3a
|   72 64 1a ea  90 a7 56 ae  ac df 8f fe  ec f1 b5 f2
|   4b 60 31 d1  d1 f0 9a 46  aa ce a7 b5  9e d2 45 a4
|   6d ea 2e 98  e3 5b 65 b1  09 65 37 24  08 8c 65 8e
|   a9 e1 67 29  81 c7 9e b3  c7 6c b6 a5  4e 2d fd 3d
|   76 9c 76 37  ce ce 49 1d  32 b3 12 45  64 a0 25 d8
|   49 0e f7 cc  9e 7f e8 ec  d8 ac 77 8b  47 df f7 5f
|   7d 26 b3 b1  7e ef 2a 9a  4b 3b 9e 64  c9 e7 58 81
|   56 b1 a5 62  fe 01 ab 48  e5 1f cd c5  72 d2 92 df
|   c3 47 b5 ae  09 18 d3 15  50 8f 16 fe  9e 41 a0 b7
|   8e 97 68 74  10 cf 90 82  ce 98 cb 22  d2 8c 4d 0e
|   12 94 07 7a  b1 1c 13 b8  51 f4 b8 4e  8f df e1 d8
|   f7 17 15 ca  db ce b1 3a  94 8c 86 3d  e2 3b cf 93
|   6e 0b 1c 1f  e9 65 1f 61  c3 58 46 c8  f7 70 fc f5
|   f2 ac 5b a8  7e fc 44 e8  06 47 24 fc  b7 42 8b 1f
|   6f 17 2c 8c  52 64 e8 90  68 39 c1 06  f4 9d df 29
|   ed 29 f8 e6  2d 46 13 0e  3e 0e 8f 71  73 2c 42 69
|   c1 58 e2 ad  a6 3c 51 d6  37 a5 32 4e  a2 4e a4 01
|   d3 b7 53 c4  4f f3 56 8c  94 1a 82 92  7c c5 e2 32
|   42 2b 38 2f  a5 16 69 82  ac 5e 13 82  e2 aa cd 39
| releasing whack for #X (sock=Y)
| releasing whack for #X (sock=Y)
RC=0 #4: "peerA--peerB":500 IKEv2.0 STATE_CHILD_C1_KEYED (CHILD SA established); none in -1s; newest IPSEC; nodpd; msgid=0; idle; import:respond to friend
RC=0 #4: "peerA--peerB":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org
RC=0 #2: "peerA--peerB":500 IKEv2.0 STATE_PARENT_R2 (received v2I2, PARENT SA established); none in -1s; newest ISAKMP; nodpd; retranscnt=0,outorder=0,last=-1,next=0,recv=1,responder; msgid=0; idle; import:respond to friend
RC=0 #2: "peerA--peerB":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org
RC=0 #3: "peerA--peerB":500 IKEv2.0 STATE_CHILD_C0_KEYING (CHILD SA keying); none in -1s; nodpd; msgid=1; idle; import:admin initiate
RC=0 #3: "peerA--peerB":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=*
RC=0 #1: "peerA--peerB":500 IKEv2.0 STATE_PARENT_I2 (sent v2I2, expected v2R2); none in -1s; nodpd; retranscnt=0,outorder=0,last=0,next=2,recv=-1,initiator; msgid=0; idle; import:admin initiate
RC=0 #1: "peerA--peerB":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=*
| duplicate parent SA looking for state matching for peerA--peerB #2
| states had different identities
3: output to OUTPUT/peerA-R3S.pcap
3: input from peerB-R2a.pcap
|   =========== input from pcap file peerB-R2a.pcap ========
| *received 1552 bytes from fe80::ec68:7cff:fe0c:9aa4:500 on eth0 (port=500)
|   8d 0e 0f 10  11 12 13 14  78 5b 90 fe  dd d1 18 2d
|   2e 20 23 20  00 00 00 01  00 00 06 10  24 00 05 f4
|   97 18 19 1a  1b 1c 1d 1e  1f 20 21 22  23 24 25 26
|   4e 05 78 72  87 19 97 02  2c 37 57 f8  96 c3 88 27
|   02 23 a8 ef  55 89 69 0e  79 74 b1 d6  22 aa cd a1
|   dd aa 0b 11  15 0d 2d 61  07 98 a5 a9  f2 b6 79 ea
|   5d b2 31 9d  8e dd 44 04  d5 97 10 62  7b a2 94 62
|   10 0e b4 04  94 0b f9 59  5d 77 79 15  f6 09 fd 5d
|   b1 9f 23 34  42 91 be 82  60 c6 14 d6  46 3d 0f 87
|   72 a2 d8 db  37 d2 df 17  07 f3 4b 09  91 c7 56 2c
|   a6 33 b7 71  39 f1 3f 89  86 e5 a1 24  72 00 b8 09
|   3c a5 ed 8c  fb 89 be 62  01 18 a2 20  97 a2 59 5f
|   62 96 f7 b8  c0 81 2b 17  46 4e 44 56  43 c8 f9 0a
|   9e bb cc 00  e7 ed 6f 50  d8 d7 c1 c3  20 c7 bc 0d
|   62 73 c9 56  de ab bd 8c  b2 fa 2c 74  8a af 17 40
|   de 21 91 92  00 ad 89 45  36 97 8b aa  e3 f9 8c 14
|   ca 56 86 d2  3d 7f 90 e6  f1 18 b8 f9  91 60 ed 12
|   e8 1c c3 e9  77 de a0 aa  dd 3f 7d e9  07 c6 03 8e
|   02 11 b2 fc  3a 61 b9 09  63 1d fe 9b  f1 b8 ca c9
|   5a 42 f8 e6  51 c7 9d 43  33 30 d9 60  0a fb 0a af
|   36 93 61 3f  35 4a 3d a1  8c f0 c5 8a  a5 9a af 47
|   2c 47 5b a9  b8 9a 5e ae  9f ab 1b a8  d9 d3 72 d0
|   a5 42 5e 1f  79 41 1f ae  08 c6 07 11  f9 a9 25 c5
|   b5 bf 5a e7  6b e2 4f 2c  d7 30 44 a2  b3 0e b6 db
|   93 fc 5e 9b  23 85 6c 81  0e 1b 9b 43  ac b5 c6 2a
|   fe 34 a5 0b  08 ca a3 13  72 5c 10 55  b8 90 8d c5
|   38 69 f9 e3  c9 96 25 8b  e9 3e e8 04  e3 f7 4d a9
|   da e2 91 ba  98 e0 98 a0  a0 f2 cf 65  d4 21 d7 a7
|   83 30 e1 49  f3 31 b4 77  a8 59 fd 90  c1 60 d6 9f
|   7f bf 0b bf  7d 6b 8b 02  5b 97 04 51  88 43 65 57
|   4c c5 8a 6e  09 2a 07 be  dd 54 4f 29  ef 37 eb 30
|   91 f7 13 97  c0 1e fb 95  0f 51 3c 17  e6 8d 03 9e
|   01 8d 8f cf  5b bf 73 e9  4f 75 97 13  38 b2 3b 91
|   df 96 6a 07  96 2b ec 7b  d5 61 03 5a  81 9b 91 82
|   77 8d 6d c6  78 50 5a bf  f6 b2 72 9c  c9 59 59 1e
|   ca 44 8b 2b  b7 3f d2 7c  f2 78 62 65  3d 58 23 76
|   74 61 7c c9  14 9e a3 36  98 02 cf 73  c2 3c 12 2c
|   57 46 b7 81  55 96 c8 08  2f 3d 92 71  1e 26 b6 8d
|   f8 b1 97 73  56 2d 98 62  33 7b b6 c0  1a a7 98 7e
|   54 ec 86 1c  b8 dc 8e 33  38 69 bd 0a  a3 98 52 6f
|   cc 13 33 f8  2f 0f 2d 07  15 0d 72 30  d2 e5 ae 4e
|   6e 48 8c eb  1f 8b b9 49  89 7f 1f 2c  36 1f 34 d0
|   df cb 64 0c  3e 3b be d9  94 b5 e5 11  13 e9 19 f4
|   d6 62 df 5d  92 93 aa de  69 65 bc e9  9e dd 6c 30
|   13 24 25 50  f7 89 a2 2b  42 e7 b6 37  71 b5 bd 97
|   42 1c 6d f9  2d cd c4 e1  82 08 2b 6b  60 38 8c 8a
|   89 3a 12 c6  0f c9 5c c1  ad f1 6f 69  3a a7 cd 76
|   54 f0 0b 2f  c5 65 a6 cc  31 3a e5 13  4e 5d f4 c0
|   fb 9d d5 bf  77 53 f7 46  87 b7 e9 70  86 39 82 a8
|   30 89 30 bd  dc e4 f6 53  90 9e ee 3c  62 20 73 53
|   d5 06 b4 6d  46 b4 f8 a1  b1 f8 b3 fd  41 89 07 7e
|   db 41 9f 3b  4d b5 8f b5  d7 f2 29 40  f8 96 02 51
|   4c bd c9 41  aa 05 de db  3d ac 3c ab  5e 48 68 9b
|   4b b7 30 c8  d6 68 1d 63  42 d7 88 e2  1d 92 27 7e
|   d3 9b 26 be  87 14 e0 69  28 05 8d 5c  27 10 48 c0
|   c2 67 63 c1  c5 55 5b be  34 a2 3f 24  2c 99 9a c7
|   f4 06 b8 9e  15 da 15 94  88 87 eb f9  4a 25 ee e2
|   53 be 7c 80  82 bb 8a e8  f7 a2 1a 23  57 76 aa fd
|   90 dd eb a7  ac 63 eb 26  46 01 42 3f  8b 01 85 1d
|   af a8 4d 74  8f 10 35 20  52 a8 05 e3  d5 e5 9a df
|   af 65 d5 82  95 31 0a dc  e6 e7 7c af  b7 a3 29 53
|   54 b1 b4 fe  5f a8 88 e7  48 53 9a 26  d6 6d 42 14
|   16 81 9b f3  83 09 40 7a  84 51 2d e8  68 63 16 e3
|   28 29 42 f7  09 36 88 62  6c 9d 72 41  67 6f c4 df
|   c5 1e 34 60  0d 02 49 a6  71 41 b1 2b  28 9b fb 00
|   65 cc 64 66  40 22 e4 ac  7c d1 41 6d  0a 5b 72 b0
|   fd 7a eb 51  bb 28 eb f1  16 5c 43 7d  55 0e 07 a5
|   7c ea ae 70  a5 0e 29 70  02 2a 00 7c  63 92 57 56
|   23 6c 48 c4  f2 66 68 ef  96 c9 02 bd  1b aa 9a 23
|   0d db 90 05  0e 4b 25 db  ef 03 7c 80  f2 ec 41 1f
|   e9 e6 24 84  64 30 f5 c2  64 2e 1d 01  10 3b 9e 01
|   d0 19 f7 ce  18 ce c5 e0  06 88 18 02  b2 6f f7 23
|   8d 09 1f 32  49 52 c9 c5  46 ff e4 8d  a2 57 65 b5
|   e6 a8 b8 f6  44 97 4f 95  b3 e7 a5 8d  e8 94 fb 43
|   f7 a3 1c 59  72 28 9d 69  73 4b 54 38  be 9d 2d 88
|   e8 32 95 cd  97 15 cf fe  d3 64 39 fe  c4 e3 ce 25
|   fb b8 41 58  13 9f f1 dd  b8 2d 59 4f  f0 62 1e 3b
|   c8 5e ee 3c  92 e3 84 3a  a4 e4 f6 ed  e9 1e 1c 65
|   07 27 ab f7  e1 e7 c6 53  27 8e 3a 4d  f0 a5 34 16
|   6f d5 17 9a  89 73 77 ae  f4 3e 5f e1  37 5b 19 4f
|   8b b5 4f 9b  68 52 3a 57  cc bb 15 f0  29 b2 5a 53
|   ea 75 9c c1  bd 8b 6b 1b  ef 7d 80 65  38 28 8c b5
|   cd ad 85 75  fc ae b1 79  33 85 47 12  38 61 50 88
|   18 d4 95 bc  78 4f 5a 22  12 f8 08 c0  c6 25 56 b2
|   29 2c c2 fe  04 db 43 ba  b0 42 b4 09  1a cb ae 80
|   1c 6b 6b 71  df 9b f8 92  b0 0b d3 47  aa aa 5c 93
|   d3 2d 01 1b  a3 2a ae c6  82 9c 00 45  a3 2e ec 5c
|   2b f6 90 92  4c 02 fc 4d  f1 2d 62 f7  5b eb c5 7e
|   bf f6 55 e6  f2 6b 3d 41  20 76 4a 96  25 5c b5 87
|   69 b2 28 85  5b ba c2 7b  25 24 a4 0e  08 3b 66 9d
|   30 b4 61 c6  4b 81 d0 6c  6c 75 d9 80  ba a9 0f 14
|   7b d4 2b 74  ac 99 28 41  17 3e d5 0c  88 5b a2 02
|   8e 93 3f a6  24 29 e5 7e  88 7a 56 ce  f0 54 a1 07
|   83 c7 19 df  2b 43 6a 0c  c8 3c 1d 13  61 78 ab f8
|   5c 37 d7 c3  7c 62 24 07  d3 17 80 f0  1d 75 2b 00
|   29 27 8f d3  b8 92 49 eb  ed d0 89 90  d8 6e 5a c8
|   59 a2 82 d8  87 43 10 ab  6f a8 be 4c  b6 c3 51 72
|  processing version=2.0 packet with exchange type=ISAKMP_v2_AUTH (35), msgid: 00000001
| I am the IKE SA Initiator
| I am this exchange's Initiator
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  78 5b 90 fe  dd d1 18 2d
| state hash entry 6
| v2 peer, cookies and msgid match on #3
| v2 state object #3 found, in STATE_CHILD_C0_KEYING
| state found and its state is:STATE_CHILD_C0_KEYING msgid: 00001
| now proceed with state specific processing using state #2 initiator-auth-process
./peerA-R3S IKEv2 mode peer ID is ID_DER_ASN1_DN: 'C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org'
./peerA-R3S v2_CERT received on initiator, attempting to validate
./peerA-R3S no crl from issuer "C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA" found (strict=no)
| reached self-signed root ca
./peerA-R3S 0: validated X509 certificate: 'C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org', added to trusted database
| ikev2 verify required CA is 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|
| List of X.509 End Certificates:
|
| NOW, count: 1
|        subject: 'C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org'
|        issuer:  'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|        serial:   0c
|        pubkey:   2048 RSA Key AwEAAeOoT
|        validity: not before Aug 07 01:03:04 UTC 2024 ok
|                  not after  Nov 15 01:03:04 UTC 2026 ok
|        subjkey:  c2:64:69:e8:dc:88:e3:23:58:47:07:86:4b:5e:d4:b3:ea:bc:a7:10
|        authkey:  86:cb:59:12:06:07:df:3f:00:36:b9:64:c6:c5:14:1f:3a:ed:cd:aa
| checking alg=1 == 1, keyid=carol@openswan.org same_id=0
| checking alg=1 == 1, keyid=dave@openswan.org same_id=0
| checking alg=1 == 1, keyid=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org same_id=0
| checking alg=1 == 1, keyid=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org same_id=1
| key issuer CA is 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
| ei->port 0  tsi[tsi_ni].startport 0  tsi[tsi_ni].endport 65535
|     evaluate_connection_port_fit tsi_n[1], best=-1
|    tsi[0] 0-65535: exact port match with 0.  fitness 65536
|       evaluating_connection_port_fit tsi_n[0], range_i=65536 best=-1
|    tsr[0] 0-65535: exact port match with 0.  fitness 65536
|       evaluating_connection_port_fit tsi_n[0] tsr_n[0], range=65536/65536 best=-1
|     best ports fit so far: tsi[0] fitrange_i 65536, tsr[0] fitrange_r 65536, matchiness 131072
|     port_fitness 131072
| protocol 0 and tsi[0].ipprotoid 0: exact match
| protocol 0 and tsr[0].ipprotoid 0: exact match
|     best protocol fit so far: tsi[0] fitrange_i 255, tsr[0] fitrange_r 255, matchiness 510
|     protocol_fitness 510
| #3 complete v2 state transition with STF_OK
./peerA-R3S transition from state STATE_CHILD_C0_KEYING to state STATE_CHILD_C1_KEYED
| v2_state_transition: st is #3; pst is #0; transition_st is #0
./peerA-R3S STATE_CHILD_C1_KEYED: CHILD SA established (msgid: 00000001/4294967295)
./peerA-R3S negotiated tunnel [::,ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff proto:0 port:0-65535] -> [::,ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff proto:0 port:0-65535]
./peerA-R3S STATE_CHILD_C1_KEYED: CHILD SA established tunnel mode {ESP=>0x34567812 <0x12345678 xfrm=aes_cbc_128-hmac_sha2_256_128 NATOA=none NATD=none DPD=none IF_id=000011d7}
| releasing whack for #X (sock=Y)
| releasing whack for #X (sock=Y)
RC=0 #4: "peerA--peerB":500 IKEv2.0 STATE_CHILD_C1_KEYED (CHILD SA established); none in -1s; nodpd; msgid=0; idle; import:respond to friend
RC=0 #4: "peerA--peerB":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org
RC=0 #2: "peerA--peerB":500 IKEv2.0 STATE_PARENT_R2 (received v2I2, PARENT SA established); none in -1s; nodpd; retranscnt=0,outorder=0,last=-1,next=0,recv=1,responder; msgid=0; idle; import:respond to friend
RC=0 #2: "peerA--peerB":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org
RC=0 #3: "peerA--peerB":500 IKEv2.0 STATE_CHILD_C1_KEYED (CHILD SA established); none in -1s; newest IPSEC; nodpd; msgid=1; idle; import:admin initiate
RC=0 #3: "peerA--peerB":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=*
RC=0 #1: "peerA--peerB":500 IKEv2.0 STATE_PARENT_I3 (PARENT SA established); none in -1s; newest ISAKMP; nodpd; retranscnt=0,outorder=0,last=1,next=2,recv=-1,initiator; msgid=0; idle; import:admin initiate
RC=0 #1: "peerA--peerB":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org
| duplicate parent SA looking for state matching for peerA--peerB #1
| same parents matches A-->B
| state #2 matches #1
./peerA-R3S state #2 duplicates #1, deleting #2
| deleting state with nonce:
|   3f 98 9d 37  a8 14 a6 4d  8f f0 7c 08  d3 20 e9 e3
./peerA-R3S initiated by peer, so it will take care of deleting #2
should have found a continuation, but none was found
4: output to OUTPUT/02_peerA-R3S.pcap
4: input from peerB-R2d.pcap
|   =========== input from pcap file peerB-R2d.pcap ========
| *received 80 bytes from fe80::ec68:7cff:fe0c:9aa4:500 on eth0 (port=500)
|   97 18 19 1a  1b 1c 1d 1e  97 03 67 ba  2d 8b a4 1d
|   2e 20 25 08  00 00 00 02  00 00 00 50  2a 00 00 34
|   97 18 19 1a  1b 1c 1d 1e  1f 20 21 22  23 24 25 26
|   eb 84 c1 d3  ec 6b 4e 3f  d6 9f 81 f0  5b a6 e2 fe
|   d0 67 fc aa  ba f3 6e 04  89 4d 01 b5  7a 18 d3 e3
|  processing version=2.0 packet with exchange type=ISAKMP_v2_INFORMATIONAL (37), msgid: 00000002
| I am the IKE SA Responder
| I am this exchange's Responder
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| v2 state object not found
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| v2 peer and cookies match on #2
| v2 state object #2 (peerA--peerB) found, in STATE_PARENT_R2
| state found and its state is:STATE_PARENT_R2 msgid: 00002
| now proceed with state specific processing using state #12 responder-authenticated-informational
sending 80 bytes for process_informational_ikev2 through eth0:500 [fe80::8054:3eff:fe9a:d3f4:500] to fe80::ec68:7cff:fe0c:9aa4:500 (using #2)
|   97 18 19 1a  1b 1c 1d 1e  97 03 67 ba  2d 8b a4 1d
|   2e 20 25 20  00 00 00 02  00 00 00 50  00 00 00 34
|   8d 0e 0f 10  11 12 13 14  15 16 17 18  19 1a 1b 1c
|   b7 39 cb 4f  7b b2 50 79  ba 0f cf 04  4b d7 07 2d
|   81 b3 ea f6  11 e8 51 51  03 9e 8b 44  24 bb e6 f4
./peerA-R3S deleting state #4 (STATE_CHILDSA_DEL)
| received request to delete child state
| now deleting the child state
| removing state object #4
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
./peerA-R3S deleting state #2 (STATE_IKESA_DEL)
| considering request to delete IKE parent state
| now deleting the IKE (or parent) state
| removing state object #2
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| #0 complete v2 state transition with STF_IGNORE
should have found a continuation, but none was found
