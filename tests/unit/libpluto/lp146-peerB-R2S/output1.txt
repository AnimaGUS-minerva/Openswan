./peerB-R2S ike_alg_register_enc(): Activating OAKLEY_AES_CBC: Ok (ret=0)
./peerB-R2S ike_alg_register_hash(): Activating OAKLEY_SHA2_512: Ok (ret=0)
./peerB-R2S ike_alg_register_prf(): Activating prf-hmac-sha2-512: Ok (ret=0)
./peerB-R2S ike_alg_register_hash(): Activating OAKLEY_SHA2_256: Ok (ret=0)
./peerB-R2S ike_alg_register_prf(): Activating prf-hmac-sha2-256: Ok (ret=0)
./peerB-R2S ike_alg_register_hash(): Activating OAKLEY_SHA1: Ok (ret=0)
./peerB-R2S ike_alg_register_prf(): Activating prf-hmac-sha1: Ok (ret=0)
./peerB-R2S ike_alg_register_hash(): Activating OAKLEY_MD5: Ok (ret=0)
./peerB-R2S ike_alg_register_prf(): Activating prf-hmac-md5: Ok (ret=0)
./peerB-R2S registered kernel encr algorithm aes_cbc [12, 128<=key<=512]
./peerB-R2S registered kernel encr algorithm 3des [3, 192<=key<=192]
./peerB-R2S registered kernel integ algorithm hmac_sha1_96 [2, 160<=key<=160]
./peerB-R2S registered kernel integ algorithm hmac_md5_96 [1, 128<=key<=128]
./peerB-R2S registered kernel integ algorithm hmac_sha2_256_128 [12, 256<=key<=256]
./peerB-R2S registered kernel integ algorithm hmac_sha2_512_256 [14, 256<=key<=256]
./peerB-R2S adjusting ipsec.d to ../samples/carol
./peerB-R2S loading secrets from "../samples/carol.secrets"
./peerB-R2S   loaded private key file '../samples/carol/private/carolKey.pem' (CERT bytes)
./peerB-R2S loaded private key for keyid: PPK_RSA:AwEAAbfz1/C529 B6C4 CDF5 97E6 322E A755 1874 D9DC DFBF 74DB
| processing whack message of size: A
| Added new connection peerB--peerA with policy RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
| counting wild cards for C=CA, ST=ON, O=Xelerance, CN=* is 1
./peerB-R2S   loading certificate from carolCert.pem
./peerB-R2S   loaded host cert file '../samples/carol/certs/carolCert.pem' (CERT bytes)
| certificate is valid
| counting wild cards for C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org is 0
| based upon ID_wildcard policy, the connection is a template.
| orient peerB--peerA checking against if: eth0 (AF_INET6:fe80::ec68:7cff:fe0c:9aa4:500)
|     orient matched on IP
|   orient peerB--peerA finished with: 1 [fe80::ec68:7cff:fe0c:9aa4]
| find_host_pair: looking for me=fe80::ec68:7cff:fe0c:9aa4:500 %address him=fe80::8054:3eff:fe9a:d3f4:500 exact-match
| find_host_pair: concluded with <none>
| connect_to_host_pair: fe80::ec68:7cff:fe0c:9aa4:500 %address fe80::8054:3eff:fe9a:d3f4:500 -> hp:none
| find_ID_host_pair: looking for me=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org him=<any> (exact)
|   concluded with <none>
./peerB-R2S adding connection: "peerB--peerA"
| ::/0===fe80::ec68:7cff:fe0c:9aa4[C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org]...fe80::8054:3eff:fe9a:d3f4[C=CA, ST=ON, O=Xelerance, CN=*]===::/0
| ike_life: 3600s; ipsec_life: 1200s; rekey_margin: 180s; rekey_fuzz: 100%; keyingtries: 1; policy: RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   orient peerB--peerA finished with: 1 [fe80::ec68:7cff:fe0c:9aa4]
RC=0 "peerB--peerA": ::/0===fe80::ec68:7cff:fe0c:9aa4[C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org]...fe80::8054:3eff:fe9a:d3f4[C=CA, ST=ON, O=Xelerance, CN=*]===::/0; unrouted; eroute owner: #0
RC=0 "peerB--peerA":     myip=unset; hisip=unset; mycert=carolCert.pem;
RC=0 "peerB--peerA":   CAs: 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'...'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
RC=0 "peerB--peerA":   keys: 1:C529 B6C4 CDF5 97E6 322E A755 1874 D9DC DFBF 74DB 2:none...
RC=0 "peerB--peerA":   ike_life: 3600s; ipsec_life: 1200s; rekey_margin: 180s; rekey_fuzz: 100%; keyingtries: 1; firstmsgid: 0
RC=0 "peerB--peerA":   policy: RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK; prio: 0,0; interface: eth0; kind=CK_TEMPLATE
| Changed path to directory '../samples/carol/cacerts'
./peerB-R2S   loaded CA cert file 'rootCA.pem' (CERT bytes)
|   authcert inserted
| Changed path to directory '../samples/carol/aacerts'
| Changed path to directory '../samples/carol/ocspcerts'
| Found -1 items in directory '../samples/carol/crls'
|
| List of X.509 End Certificates:
|
| NOW, count: 1
|        subject: 'C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org'
|        issuer:  'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|        serial:   05
|        pubkey:   2048 RSA Key AwEAAbfz1
|        validity: not before Sep 03 04:15:59 UTC 2019 ok
|                  not after  Dec 11 04:15:59 UTC 2021 ok
|        subjkey:  5c:59:70:62:57:2d:2a:24:9c:5c:94:56:9b:89:5e:e5:c5:05:b6:bd
|        authkey:  86:cb:59:12:06:07:df:3f:00:36:b9:64:c6:c5:14:1f:3a:ed:cd:aa
| find_phase1_state: no SA found for conn 'peerB--peerA'
| creating state object #1 at Z
| orient peerB--peerA checking against if: eth0 (AF_INET6:fe80::ec68:7cff:fe0c:9aa4:500)
|     orient matched on IP
|   orient peerB--peerA finished with: 1 [fe80::ec68:7cff:fe0c:9aa4]
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| inserting state object #1 bucket: 4
./peerB-R2S initiating v2 parent SA
./peerB-R2S STATE_PARENT_I1: initiate
sending 652 bytes for ikev2_parent_outI1_common through eth0:500 [fe80::ec68:7cff:fe0c:9aa4:500] to fe80::8054:3eff:fe9a:d3f4:500 (using #1)
|   97 18 19 1a  1b 1c 1d 1e  00 00 00 00  00 00 00 00
|   21 20 22 08  00 00 00 00  00 00 02 8c  22 00 01 0c
|   02 00 00 2c  01 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  02 00 00 05  03 00 00 08
|   03 00 00 0c  00 00 00 08  04 00 00 0e  02 00 00 2c
|   02 01 00 04  03 00 00 0c  01 00 00 0c  80 0e 00 80
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 2c  03 01 00 04
|   03 00 00 0c  01 00 00 0c  80 0e 00 80  03 00 00 08
|   02 00 00 05  03 00 00 08  03 00 00 0c  00 00 00 08
|   04 00 00 05  02 00 00 2c  04 01 00 04  03 00 00 0c
|   01 00 00 0c  80 0e 00 80  03 00 00 08  02 00 00 05
|   03 00 00 08  03 00 00 02  00 00 00 08  04 00 00 05
|   02 00 00 2c  05 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  02 00 00 05  03 00 00 08
|   03 00 00 0c  00 00 00 08  04 00 00 0f  00 00 00 2c
|   06 01 00 04  03 00 00 0c  01 00 00 0c  80 0e 00 80
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 02
|   00 00 00 08  04 00 00 0f  28 00 01 08  00 0e 00 00
|   3d a6 6a 81  e2 92 09 be  18 4f a0 1e  5c ed ea 7c
|   7d 7b 3a 21  3e 15 0d 53  5d 17 6a be  1b c5 70 ab
|   34 47 bc 09  14 7c aa 91  9c 8f 81 dc  1e f9 87 cd
|   6a ec fa f3  a5 9e 37 bc  ac 3d fd e1  32 8e e8 b3
|   fe d3 8b f4  7b 50 34 13  33 7a 93 ea  e9 3c 0e 8b
|   bd 48 18 9c  9e 03 70 f2  55 ce 45 22  9f c7 c9 48
|   43 a3 e2 64  b5 5d 43 38  c8 fe f1 d3  06 43 f0 0a
|   e8 6d 61 8c  60 78 d9 98  d3 1b 3b 5e  f5 a6 e8 2f
|   ef 56 ac b4  33 bd 1e 62  b2 3e 0b 17  af 6c b8 31
|   08 d7 19 5a  7b c4 54 c2  13 47 98 c2  cc d2 16 29
|   75 6c 03 fb  1e 9c 9d 21  0c a1 e6 c2  f3 f2 49 2c
|   f6 06 73 c1  96 1e ce 58  81 01 1c cb  16 dc f9 fc
|   c7 93 08 75  58 16 57 71  69 96 66 b7  a9 81 7f f7
|   37 4d 7c 41  38 62 a6 39  00 81 ca 3d  1d fc f7 b5
|   08 38 d4 34  70 22 6c 21  d2 5b 20 a1  d2 ba 2a d1
|   89 f3 20 79  ce ac 1e c2  ec 7d ae 76  94 40 39 a0
|   29 00 00 14  20 98 9d 37  a8 14 a6 4d  8f f0 7c 08
|   d3 20 e9 e3  29 00 00 1c  00 00 40 04  49 0b 02 0c
|   ad ca e0 33  2f b2 0d 95  c3 9b c1 e5  d4 c2 70 6f
|   2b 00 00 1c  00 00 40 05  57 bb 48 a3  14 b1 6f 2b
|   12 90 41 fd  6d 20 1a 3d  79 43 7a f7  00 00 00 10
|   4f 45 ab ab  ab ab ab ab  ab ab ab ab
| #1 complete v2 state transition with STF_OK
./peerB-R2S transition from state STATE_IKEv2_START to state STATE_PARENT_I1
| v2_state_transition: st is #1; pst is #0; transition_st is #0
./peerB-R2S STATE_PARENT_I1: sent v2I1, expected v2R1 (msgid: 00000000/4294967295)
0: input from peerA-I1.pcap
|   =========== input from pcap file peerA-I1.pcap ========
| *received 652 bytes from fe80::8054:3eff:fe9a:d3f4:500 on eth0 (port=500)
|   8d 0e 0f 10  11 12 13 14  00 00 00 00  00 00 00 00
|   21 20 22 08  00 00 00 00  00 00 02 8c  22 00 01 0c
|   02 00 00 2c  01 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  02 00 00 05  03 00 00 08
|   03 00 00 0c  00 00 00 08  04 00 00 0e  02 00 00 2c
|   02 01 00 04  03 00 00 0c  01 00 00 0c  80 0e 00 80
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 2c  03 01 00 04
|   03 00 00 0c  01 00 00 0c  80 0e 00 80  03 00 00 08
|   02 00 00 05  03 00 00 08  03 00 00 0c  00 00 00 08
|   04 00 00 05  02 00 00 2c  04 01 00 04  03 00 00 0c
|   01 00 00 0c  80 0e 00 80  03 00 00 08  02 00 00 05
|   03 00 00 08  03 00 00 02  00 00 00 08  04 00 00 05
|   02 00 00 2c  05 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  02 00 00 05  03 00 00 08
|   03 00 00 0c  00 00 00 08  04 00 00 0f  00 00 00 2c
|   06 01 00 04  03 00 00 0c  01 00 00 0c  80 0e 00 80
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 02
|   00 00 00 08  04 00 00 0f  28 00 01 08  00 0e 00 00
|   3d a6 6a 81  e2 92 09 be  18 4f a0 1e  5c ed ea 7c
|   7d 7b 3a 21  3e 15 0d 53  5d 17 6a be  1b c5 70 ab
|   34 47 bc 09  14 7c aa 91  9c 8f 81 dc  1e f9 87 cd
|   6a ec fa f3  a5 9e 37 bc  ac 3d fd e1  32 8e e8 b3
|   fe d3 8b f4  7b 50 34 13  33 7a 93 ea  e9 3c 0e 8b
|   bd 48 18 9c  9e 03 70 f2  55 ce 45 22  9f c7 c9 48
|   43 a3 e2 64  b5 5d 43 38  c8 fe f1 d3  06 43 f0 0a
|   e8 6d 61 8c  60 78 d9 98  d3 1b 3b 5e  f5 a6 e8 2f
|   ef 56 ac b4  33 bd 1e 62  b2 3e 0b 17  af 6c b8 31
|   08 d7 19 5a  7b c4 54 c2  13 47 98 c2  cc d2 16 29
|   75 6c 03 fb  1e 9c 9d 21  0c a1 e6 c2  f3 f2 49 2c
|   f6 06 73 c1  96 1e ce 58  81 01 1c cb  16 dc f9 fc
|   c7 93 08 75  58 16 57 71  69 96 66 b7  a9 81 7f f7
|   37 4d 7c 41  38 62 a6 39  00 81 ca 3d  1d fc f7 b5
|   08 38 d4 34  70 22 6c 21  d2 5b 20 a1  d2 ba 2a d1
|   89 f3 20 79  ce ac 1e c2  ec 7d ae 76  94 40 39 a0
|   29 00 00 14  20 98 9d 37  a8 14 a6 4d  8f f0 7c 08
|   d3 20 e9 e3  29 00 00 1c  00 00 40 04  71 c6 1d 0c
|   a0 a6 22 3b  41 5a 37 ec  dc 7c 2f 46  44 8c 79 25
|   2b 00 00 1c  00 00 40 05  97 ba 1b c9  89 17 f2 d1
|   e4 fd 0d 23  b7 bf cc b4  38 02 c9 d2  00 00 00 10
|   4f 45 ab ab  ab ab ab ab  ab ab ab ab
|  processing version=2.0 packet with exchange type=ISAKMP_v2_SA_INIT (34), msgid: 00000000
| I am the IKE SA Responder
| I am this exchange's Responder
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| v2 state object not found
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| v2 state object not found
| now proceed with state specific processing using state #3 responder-V2_init
./peerB-R2S tentatively considering connection: peerB--peerA
| creating state object #2 at Z
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  78 5b 90 fe  dd d1 18 2d
| state hash entry 6
| inserting state object #2 bucket: 6
| received a notify..
| #2 complete v2 state transition with STF_SUSPEND
| selected proposal 1 encr=aes_cbc[128] integ=hmac_sha2_256_128 prf=prf-hmac-sha2-256 modp=OAKLEY_GROUP_MODP2048
| Thinking about sending a certificate request (CERTREQ)
|   my policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   my next payload will be a certificate request
| have CA 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA', send CERTREQ with CA's Key ID
| #2 complete v2 state transition with STF_OK
./peerB-R2S transition from state STATE_IKEv2_START to state STATE_PARENT_R1
| v2_state_transition: st is #2; pst is #0; transition_st is #2
./peerB-R2S STATE_PARENT_R1: received v2I1, sent v2R1 (msgid: 00000000/00000000)
| sending reply packet to fe80::8054:3eff:fe9a:d3f4:500 (from port 500)
sending 457 bytes for STATE_IKEv2_START through eth0:500 [fe80::ec68:7cff:fe0c:9aa4:500] to fe80::8054:3eff:fe9a:d3f4:500 (using #2)
|   8d 0e 0f 10  11 12 13 14  78 5b 90 fe  dd d1 18 2d
|   21 20 22 20  00 00 00 00  00 00 01 c9  22 00 00 30
|   00 00 00 2c  01 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  03 00 00 0c  03 00 00 08
|   02 00 00 05  00 00 00 08  04 00 00 0e  28 00 01 08
|   00 0e 00 00  bd 48 18 9c  9e 03 70 f2  55 ce 45 22
|   9f c7 c9 48  43 a3 e2 64  b5 5d 43 38  c8 fe f1 d3
|   06 43 f0 0a  e8 6d 61 8c  60 78 d9 98  d3 1b 3b 5e
|   f5 a6 e8 2f  ef 56 ac b4  33 bd 1e 62  b2 3e 0b 17
|   af 6c b8 31  08 d7 19 5a  7b c4 54 c2  13 47 98 c2
|   cc d2 16 29  75 6c 03 fb  1e 9c 9d 21  0c a1 e6 c2
|   f3 f2 49 2c  f6 06 73 c1  96 1e ce 58  81 01 1c cb
|   16 dc f9 fc  c7 93 08 75  58 16 57 71  69 96 66 b7
|   a9 81 7f f7  37 4d 7c 41  38 62 a6 39  00 81 ca 3d
|   1d fc f7 b5  08 38 d4 34  70 22 6c 21  d2 5b 20 a1
|   d2 ba 2a d1  89 f3 20 79  ce ac 1e c2  ec 7d ae 76
|   94 40 39 a0  3d a6 6a 81  e2 92 09 be  18 4f a0 1e
|   5c ed ea 7c  7d 7b 3a 21  3e 15 0d 53  5d 17 6a be
|   1b c5 70 ab  34 47 bc 09  14 7c aa 91  9c 8f 81 dc
|   1e f9 87 cd  6a ec fa f3  a5 9e 37 bc  ac 3d fd e1
|   32 8e e8 b3  fe d3 8b f4  7b 50 34 13  33 7a 93 ea
|   e9 3c 0e 8b  29 00 00 14  20 98 9d 37  a8 14 a6 4d
|   8f f0 7c 08  d3 20 e9 e3  29 00 00 1c  00 00 40 04
|   67 1e 35 d8  ca 06 d5 88  dd 32 62 02  d3 1d 16 89
|   2b 2a e7 59  26 00 00 1c  00 00 40 05  54 b7 34 30
|   9a 69 ed db  c7 ba 43 77  83 8e 3c b6  fc e1 04 cf
|   2b 00 00 19  04 86 cb 59  12 06 07 df  3f 00 36 b9
|   64 c6 c5 14  1f 3a ed cd  aa 00 00 00  10 4f 45 70
|   6c 75 74 6f  75 6e 69 74  30
1: input from peerA-R1a.pcap
|   =========== input from pcap file peerA-R1a.pcap ========
| *received 457 bytes from fe80::8054:3eff:fe9a:d3f4:500 on eth0 (port=500)
|   97 18 19 1a  1b 1c 1d 1e  97 03 67 ba  2d 8b a4 1d
|   21 20 22 20  00 00 00 00  00 00 01 c9  22 00 00 30
|   00 00 00 2c  01 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  03 00 00 0c  03 00 00 08
|   02 00 00 05  00 00 00 08  04 00 00 0e  28 00 01 08
|   00 0e 00 00  bd 48 18 9c  9e 03 70 f2  55 ce 45 22
|   9f c7 c9 48  43 a3 e2 64  b5 5d 43 38  c8 fe f1 d3
|   06 43 f0 0a  e8 6d 61 8c  60 78 d9 98  d3 1b 3b 5e
|   f5 a6 e8 2f  ef 56 ac b4  33 bd 1e 62  b2 3e 0b 17
|   af 6c b8 31  08 d7 19 5a  7b c4 54 c2  13 47 98 c2
|   cc d2 16 29  75 6c 03 fb  1e 9c 9d 21  0c a1 e6 c2
|   f3 f2 49 2c  f6 06 73 c1  96 1e ce 58  81 01 1c cb
|   16 dc f9 fc  c7 93 08 75  58 16 57 71  69 96 66 b7
|   a9 81 7f f7  37 4d 7c 41  38 62 a6 39  00 81 ca 3d
|   1d fc f7 b5  08 38 d4 34  70 22 6c 21  d2 5b 20 a1
|   d2 ba 2a d1  89 f3 20 79  ce ac 1e c2  ec 7d ae 76
|   94 40 39 a0  3d a6 6a 81  e2 92 09 be  18 4f a0 1e
|   5c ed ea 7c  7d 7b 3a 21  3e 15 0d 53  5d 17 6a be
|   1b c5 70 ab  34 47 bc 09  14 7c aa 91  9c 8f 81 dc
|   1e f9 87 cd  6a ec fa f3  a5 9e 37 bc  ac 3d fd e1
|   32 8e e8 b3  fe d3 8b f4  7b 50 34 13  33 7a 93 ea
|   e9 3c 0e 8b  29 00 00 14  20 98 9d 37  a8 14 a6 4d
|   8f f0 7c 08  d3 20 e9 e3  29 00 00 1c  00 00 40 04
|   0b 20 60 e6  6e f9 4d 29  d9 06 93 6c  d5 6c 67 a8
|   7b ce 16 d5  26 00 00 1c  00 00 40 05  76 47 fe 79
|   df 56 95 f2  3a e3 71 d3  0d 55 fa 61  fe 77 7a ca
|   2b 00 00 19  04 86 cb 59  12 06 07 df  3f 00 36 b9
|   64 c6 c5 14  1f 3a ed cd  aa 00 00 00  10 4f 45 70
|   6c 75 74 6f  75 6e 69 74  30
|  processing version=2.0 packet with exchange type=ISAKMP_v2_SA_INIT (34), msgid: 00000000
| I am the IKE SA Initiator
| I am this exchange's Initiator
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| v2 state object not found
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| v2 state object not found
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| v2 peer and cookies match on #1
| v2 state object #1 (peerB--peerA) found, in STATE_PARENT_I1
| removing state object #1
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| inserting state object #1 bucket: 2
| state found and its state is:STATE_PARENT_I1 msgid: 00000
| now proceed with state specific processing using state #0 initiator-V2_init
| requested CA keyID  86 cb 59 12  06 07 df 3f  00 36 b9 64  c6 c5 14 1f
|   3a ed cd aa
| selected proposal 1 encr=aes_cbc[128] integ=hmac_sha2_256_128 prf=prf-hmac-sha2-256 modp=OAKLEY_GROUP_MODP2048
| #1 complete v2 state transition with STF_SUSPEND
| duplicating state object #1
| creating state object #3 at Z
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| inserting state object #3 bucket: 2
| IKEv2 thinking whether to send my certificate:
|  my policy has  RSASIG, the policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|  sendcert: CERT_ALWAYSSEND and I did get a certificate request
|  so send cert.
| Thinking about sending a certificate request (CERTREQ)
|   my policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   my next payload will be a certificate request
| going to send a certreq
| have CA 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA', send CERTREQ with CA's Key ID
|  payload after AUTH will be ISAKMP_NEXT_v2SA
| #3 complete v2 state transition with STF_OK
./peerB-R2S transition from state STATE_PARENT_I1 to state STATE_PARENT_I2
| v2_state_transition: st is #3; pst is #1; transition_st is #1
./peerB-R2S STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 oursig=fakesig1 theirsig= cipher=aes_128 integ=sha256_128 prf=prf-hmac-sha2-256 group=modp2048} (msgid: 00000000/4294967295)
| sending reply packet to fe80::8054:3eff:fe9a:d3f4:500 (from port 500)
sending 1616 bytes for STATE_PARENT_I1 through eth0:500 [fe80::ec68:7cff:fe0c:9aa4:500] to fe80::8054:3eff:fe9a:d3f4:500 (using #3)
|   97 18 19 1a  1b 1c 1d 1e  97 03 67 ba  2d 8b a4 1d
|   2e 20 23 08  00 00 00 01  00 00 06 50  23 00 06 34
|   97 18 19 1a  1b 1c 1d 1e  1f 20 21 22  23 24 25 26
|   80 2d 7a 14  99 fe 16 66  77 d4 cc 64  d4 06 40 58
|   66 0d 93 04  8b da af 6b  a0 4f 10 03  6c be 1f a1
|   7b f5 3a b3  87 be 5a b1  7d 4d 6f 67  b5 92 53 bd
|   57 cb 48 81  71 63 0d a3  cf 35 10 f4  5d b2 0c 62
|   68 13 69 55  cd 46 a7 9a  e3 e1 da 1f  29 4a a7 1c
|   88 f9 7d 7c  7e d8 d4 bb  3c cf ed 92  4c 03 3c 0d
|   47 c2 6a d9  ea c4 79 c0  89 19 66 d9  8f 4d 67 d7
|   e6 5b a8 e6  3d 48 ff 3a  b2 dc 5c 78  1b cc f2 11
|   65 b5 5e 4d  b5 2c 94 1a  2c 76 d5 f9  55 05 4a 67
|   c8 f2 82 bf  59 52 a7 1d  b0 9f 47 74  c2 4a e2 b9
|   af 74 2d b4  90 34 7c 17  3f 35 f0 fa  ff 01 07 df
|   94 91 60 b7  21 7f dc 6c  89 2a db 5a  15 47 c2 e6
|   0a 37 6f 53  8e c8 6e cb  e4 83 84 94  cb 7d 72 ad
|   b2 b5 be 7f  17 38 fa 1b  e5 86 e6 2e  26 bd 8d 9e
|   22 c8 99 49  23 6f d9 21  fa 53 a8 e1  5c f8 38 fe
|   b8 c8 47 70  b7 c1 df d9  83 4e 32 62  d5 2b 5b 87
|   5d c4 a1 71  d0 ce c8 02  1b 79 48 76  7e a8 51 0a
|   49 fb 0d 13  c6 a7 f1 13  3a 35 af c7  8e 41 19 34
|   62 a7 2c aa  9f 87 1f 6c  e1 7c fa 96  28 27 89 3f
|   29 e1 45 9c  59 ed 34 d7  1a 48 3d 1f  02 ce 39 d2
|   2d 91 b4 3a  0b 56 f4 12  e2 21 48 86  56 98 c1 18
|   cc d8 da 36  f7 7c d8 b5  09 80 04 77  d9 56 5e de
|   e3 83 4a d2  c6 bb ba b0  85 46 28 7a  27 c2 c5 21
|   70 ff d5 78  3d 97 20 a2  01 e7 1e b7  cf 74 27 a7
|   f4 c4 a8 81  63 c5 86 bf  d6 29 40 3d  e0 f3 5f 80
|   d5 55 7e d7  e2 28 ca e0  a4 77 80 b7  b4 6c bc ff
|   d1 00 60 f4  c3 43 0f 04  9f bb a6 23  04 ba 66 08
|   42 54 7e 55  2e 0f 07 91  de 44 22 b2  4e 30 d6 31
|   36 87 c9 7f  55 f2 49 8b  42 81 e9 bf  04 11 0b 8e
|   d8 82 10 02  bd f6 4e da  12 ac e8 de  ef 97 1a 55
|   1f 5d 28 71  0c 32 7c a1  d1 15 80 03  c2 bd 61 96
|   63 b7 91 87  d5 8b 32 b8  63 53 71 1e  be 5e dc 24
|   9d aa b4 8a  12 88 32 9d  55 b2 89 88  bf c8 46 4b
|   45 b0 ce 9c  97 5e 7f b4  ec 96 be c6  9a ac 17 84
|   f2 4a 04 25  93 64 7a ab  df ec 9b b2  64 75 bd 40
|   85 a4 60 e7  a4 c2 1f b8  24 3c 7d 51  e0 27 d7 a3
|   5d ed 34 bd  32 ac 05 b7  a2 00 58 9d  b9 0f ee 0d
|   ae 66 f2 1d  7e bb 84 48  d8 68 ac 06  7c 7c 3a 25
|   72 06 23 99  a5 a8 52 3c  89 09 1b c4  0d e8 35 5c
|   89 14 39 b1  c7 b5 e0 18  12 49 0a 04  87 d8 cf e3
|   68 bc 15 62  8a 10 7d a5  02 30 66 60  b0 a8 4e c6
|   11 54 f1 ac  8d fb a1 2d  9b c8 f1 0d  42 0a cf 17
|   1f 87 64 69  7c 0d f2 ea  88 2a 2d a7  69 91 04 3b
|   4e a0 1f 5d  69 4a ad 9e  a9 f9 95 06  b4 6b 8d 51
|   22 17 ed 68  00 83 f5 b9  56 1f c5 c1  23 c2 7e 7e
|   c3 48 e6 d3  79 a6 ff d9  16 96 16 2c  ea 12 e9 a0
|   fd b8 0c fc  7e 84 d7 65  62 a8 34 ae  7d 26 6b 72
|   f9 b3 4e de  5b cf 2b f8  18 9a fd 02  40 e9 58 aa
|   82 f8 8a dc  df 2e f5 5a  f8 61 c7 cd  bf 92 d5 a9
|   ea 50 e9 a6  58 cc aa 54  77 77 fc d5  1d c8 b1 2a
|   51 1f f3 7a  06 bb cc f6  27 c9 56 6b  d0 ce 90 54
|   92 25 43 72  e9 ba 85 da  cc 0a 70 84  c5 6e 8b 3f
|   ad 04 51 d1  6f bc fd 40  32 bd a0 40  0c eb 85 33
|   f2 d5 e0 6c  ab d7 48 d4  6d d9 8a 0b  12 d1 ca 53
|   6a 7c 23 29  12 d1 3a 7a  f9 76 33 0b  f6 6a 2a cb
|   5a 47 cf 3e  08 f7 9e 42  65 78 ef 75  13 1d e6 9d
|   2c 9e e3 02  5a d5 59 5a  27 18 d5 9a  82 d9 7d fb
|   1a 67 44 b8  00 81 8b b4  85 f5 e3 98  52 22 86 4e
|   96 61 a0 e8  50 d7 ee d0  75 a2 b1 51  36 05 d2 3a
|   e2 81 1a 9c  d8 0f 13 01  5f 6c eb 33  17 c8 08 50
|   8e f1 71 2d  b0 9d f3 5c  aa eb 88 6c  26 a2 2d a5
|   04 fc 12 73  46 d0 c1 e3  87 72 07 1a  04 14 cf f6
|   b8 e5 ee 90  24 ad 7e 10  fe b4 e2 d9  bd 21 2c 93
|   7a b7 ff d5  94 99 7f 3e  0c 91 58 e5  be 8d bf e6
|   87 28 d4 c0  81 fe 3c a0  f5 e3 0a 6a  63 c6 bf 8f
|   c7 36 0c 91  46 92 e7 45  91 b1 97 8c  19 aa f5 eb
|   18 02 8c 7a  82 d0 fa bc  22 8b 59 b8  d8 30 ee 0c
|   c0 c9 5d 05  5a 4e 5b f2  5c 09 a6 8f  ca c8 19 61
|   52 fb 24 f6  a7 fc a2 d4  4f e0 50 61  fe 90 39 db
|   50 30 18 88  b4 60 87 0d  d7 2e 97 d4  a2 1c 00 91
|   20 c7 9e b2  43 04 99 cf  63 c2 6f 86  24 87 05 e6
|   ba 92 1f 45  c8 8c b0 9f  e2 c5 f5 7b  3e 33 61 25
|   88 be 41 ff  53 01 7b 9f  f4 18 5f 6a  e7 65 00 c1
|   95 ab 5a 69  fb 0b 47 1f  3f 39 85 0c  24 b9 6c f4
|   1c 40 81 da  ba d0 99 4b  5d 51 d2 7c  0d 1c 7a 57
|   f7 d7 87 61  fe db 46 99  ce 2f 27 aa  d7 62 2d 91
|   f0 c8 23 dc  ce eb 6f 09  bf 59 28 d5  a3 b1 39 74
|   ac be 9e 27  7b f3 75 4f  af f4 3e c0  bc e3 4b 06
|   44 66 91 38  3f 77 9f a6  02 45 11 ca  cd de d2 45
|   01 1b ad 9f  dd 4e d9 c1  e3 e3 69 11  77 be c6 b0
|   01 1c 62 cd  91 e3 a0 ef  74 46 6b b6  7e 66 b6 2f
|   11 a9 b5 04  cb 29 bd 29  cc 4f bf c5  c6 cd d2 4c
|   6e 46 49 5f  72 90 59 07  49 24 26 bb  e4 24 75 1d
|   ee 9a 11 e2  0a 4c 09 72  c7 3c 79 3c  09 d4 e2 97
|   c8 b9 c4 d4  1d 24 b7 e8  3d f4 1c 17  8a 12 c7 33
|   19 5a 63 4b  bb b3 11 8c  1e c0 bd 88  51 cd cc 50
|   ff 9c ab b9  7c f5 02 40  ff 3c 8a 8f  72 c3 7e 10
|   80 0d 38 9a  82 49 79 fc  da d3 f5 51  c0 4a 14 3e
|   8b 3d 27 ff  3a 01 d9 7a  f6 70 bc b3  09 df 3e 43
|   35 2c 73 16  1d 2a f3 f0  de d3 61 de  25 f3 c2 cf
|   97 88 0a 48  a9 9a 16 3e  09 f3 87 f0  1c 5a 1d 86
|   aa 26 02 14  56 6c 75 f3  ac a4 91 f2  e8 d5 64 bd
|   f6 ac 35 b0  67 0b 3e fd  71 8f a0 36  24 15 4c a0
|   74 a4 3b dd  f3 7c 1c f9  5d cd 83 a2  b7 07 59 a3
|   b6 2c 95 1f  98 f0 bd 9d  b9 fa 8a 7b  3f bf cb 75
|   09 61 e1 9f  fa 56 ba d4  19 c7 93 fd  e0 42 76 97
|   23 83 1a 12  59 50 b7 9a  1a 4c 0a 2d  27 c9 f2 77
|   33 71 ec 1b  69 f3 1b d3  7f a0 7f f5  22 ae 4c 0a
2: output to OUTPUT/peerB-R2S.pcap
2: input from peerA-I2b.pcap
|   =========== input from pcap file peerA-I2b.pcap ========
| *received 1616 bytes from fe80::8054:3eff:fe9a:d3f4:500 on eth0 (port=500)
|   8d 0e 0f 10  11 12 13 14  78 5b 90 fe  dd d1 18 2d
|   2e 20 23 08  00 00 00 01  00 00 06 50  23 00 06 34
|   8d 0e 0f 10  11 12 13 14  15 16 17 18  19 1a 1b 1c
|   67 a7 d9 8f  d5 3a c4 a5  01 f5 8f f2  15 07 1f 4b
|   4b f9 31 1a  0a d1 98 77  39 d8 e6 6d  4e b6 cb 05
|   9a 21 28 8b  3c a5 27 1c  a4 52 f8 32  c0 bd b4 19
|   72 57 22 a8  3d 5a bd d9  19 77 65 ec  85 a5 e7 c4
|   a5 f5 fd 45  ec 9a 1e db  a2 67 00 a6  fb 3c 32 4e
|   c2 2e 2a 35  ef 5a 27 6a  08 93 83 41  f7 c7 ed 00
|   48 69 6b 04  45 f1 9e 6e  1f 6f fe 00  69 25 4a 32
|   67 13 d4 8a  29 2c 0c 6e  f3 8b b3 e7  dc bb 73 f1
|   c4 1b e2 bc  e8 f3 da 9c  18 7f 31 1b  e4 9a e1 44
|   de 07 6d 77  6d 26 c8 ee  3f 3b 27 a2  f9 e4 1d 83
|   38 45 0f 43  2f 48 5f 11  7b 22 c3 c5  01 b3 c5 21
|   5f 40 d1 43  23 4b 9f 6d  05 e3 73 87  74 2b 8d 83
|   13 f4 e1 17  97 35 04 ec  ff d9 43 22  82 ac 11 ff
|   a5 84 91 90  b6 07 68 88  13 df dd e7  b7 97 60 d6
|   23 59 5d 42  52 b4 cd 66  10 d8 ed a4  1d bf ec 40
|   c8 9c 6a 03  8f ce f5 57  9f b2 4a e5  93 8f a9 c1
|   11 3f 4f 04  e0 96 69 06  82 ce d1 1b  9a 6b 44 9d
|   c6 72 18 84  80 23 c8 c4  cf f9 6e 3a  65 60 54 6c
|   1b ee bf f7  28 9b e7 e9  17 b2 2a a3  69 63 31 25
|   a9 d7 ef 9c  c7 de c6 6a  96 d8 01 5e  3d 44 9f 36
|   b6 64 a4 23  1c a6 e1 54  0c b4 3b 8c  03 85 9f b7
|   eb 6d 4c 59  89 c8 3b e8  fa da fe c8  95 2f ac 38
|   62 d6 04 40  21 d0 b4 1e  6b 6d e5 3b  4b a6 4a fc
|   0b 56 20 4d  c0 bd e2 9b  7f 78 5b 25  a2 0f b0 0d
|   a0 8b 6d 37  4d d8 a2 b7  f5 29 cb 0b  1d 89 83 2c
|   a9 cc ce 94  31 02 5c 3d  40 14 c6 2c  e0 49 ae ad
|   74 d3 d7 93  cd 52 a7 d2  4f 16 c5 d3  7b 47 9f 34
|   b0 95 9d ea  11 4a 5e 6a  9b 93 fd d7  8d 8c d9 bb
|   d3 90 ef 44  ab af e6 c2  fe db 07 4c  63 f5 96 22
|   ad 35 02 9b  32 6c a7 e4  6b 19 bb 30  17 de 68 fa
|   06 a3 dc 40  90 74 2a 6e  d0 f6 21 cb  f0 20 5a dd
|   12 19 28 68  2e 8f 39 5e  37 25 3f c8  34 f4 10 9c
|   04 4a ac 6a  0c 47 90 57  2b 4d 64 22  ab 78 77 b5
|   ff 0e 55 1b  49 28 63 f4  af c5 64 22  54 d8 75 45
|   de 8c cf dd  ba 6c 9b 05  aa 8c 5d 10  5f f8 ca 6f
|   fb 4d cd 38  d6 4e ce 40  3b 99 6b 49  a2 c4 2b 3b
|   22 97 20 3e  58 b0 84 d9  08 e9 ca 27  8e fe aa f8
|   fe 61 4f 0b  7b 41 1b a9  12 17 61 61  49 df a5 82
|   f9 65 6e 50  d9 15 da 67  80 eb e9 60  d8 33 ba 30
|   3d 08 b3 26  61 95 d6 75  c5 2e 95 0e  13 70 e1 29
|   f8 c1 0c b9  da 61 0b 12  99 56 26 e6  a3 9c db 88
|   69 52 a1 8c  cc 1b a9 b9  ec 84 6c fb  0f de f5 3d
|   30 fb cb ce  46 55 bb f4  ee b5 13 e4  b3 be 72 72
|   2d b5 70 57  64 aa d3 26  cb 7d 1d 14  63 65 50 ee
|   b6 2c 36 20  5a 5e 54 38  4d 72 1c 46  12 4d 96 3d
|   cf 75 66 96  ea 7e 63 ac  12 8b 13 85  a0 c6 80 fd
|   49 ef e9 60  60 bb 13 6b  69 ee 57 06  f7 af 15 34
|   c8 fb 60 b2  6c 43 cb f5  1d d3 a2 7a  45 5c 3f 57
|   24 94 d6 f0  2a b9 f3 ec  af 30 e9 8a  d5 b8 4b f2
|   1f 31 e9 9d  c9 77 da f3  0f 2d e5 17  3f 27 53 17
|   12 d5 49 4b  36 46 88 c6  6e 6f 29 1f  e8 af 84 f4
|   00 a7 27 ae  eb 3e 46 9c  84 88 66 d4  d7 41 55 10
|   a1 69 b9 eb  88 01 e3 41  aa 66 a7 ad  ce 26 aa 04
|   6f f8 de 1a  f7 67 07 5a  78 ef 89 ee  f1 7c 72 b5
|   6d 88 ef 84  1e 90 db 04  0e 09 a2 67  75 2e c7 4c
|   76 0e 8f 1b  2b 18 15 f5  c8 a0 bf c5  6a 65 8b 17
|   95 d9 db c0  e5 c7 db 83  9c 3a 0d ea  4d 3e b7 1c
|   c8 e6 18 91  1a 60 0f 83  9b 3d 06 73  4b 70 75 60
|   ad 6c 33 bf  48 32 d9 12  fe 8a c0 b7  96 ca 76 50
|   a1 3a 67 a8  05 4d 55 0b  5d c7 2e a7  84 78 0f bb
|   e0 28 12 d2  f6 f3 a3 29  25 71 52 55  99 62 4f a3
|   78 26 b5 7c  b6 25 eb 2e  2c a0 c9 d8  10 f9 70 8e
|   2e 41 25 8c  c8 60 65 d2  85 8b 53 15  2a 49 f0 76
|   75 59 cb af  5a 67 e2 93  4a c5 62 19  35 dd 4c 5d
|   f2 52 47 85  00 17 fe 89  7b 13 a4 93  3a 8c 07 f8
|   c5 55 d0 d0  0b 72 e9 5a  74 b0 5c 3c  f9 4b d2 e6
|   ef 7f 1f b9  09 07 78 8f  f5 bd c8 df  ab 2a 52 16
|   bf ee a5 6c  70 d5 7f 3d  1b 57 af 1b  c0 7c 4e 34
|   e0 12 e5 33  06 af 57 52  4d b3 6f ed  7d cb 71 8e
|   c7 d3 de 41  4c c7 d6 1c  4d 56 7b 9e  c6 55 20 ee
|   81 2e 63 db  97 8b 47 70  86 0a ee bf  42 ad 53 d5
|   02 f2 36 a6  89 8d 44 09  44 23 11 ca  76 18 d5 9a
|   c4 64 40 7d  50 2b 34 93  46 d8 d2 40  cb d6 31 6e
|   b4 07 7d 83  27 80 37 ab  43 cd 7b 46  ac 45 37 44
|   7c 10 d0 11  bb 2f 9c ae  e3 02 d2 56  0a f9 31 e2
|   35 d4 70 1f  94 bc 53 a0  a4 0e c6 81  b3 ea 3f 4b
|   c0 6c 59 67  6e f4 9f cc  cb 01 a5 68  ac f4 40 44
|   f0 c7 51 c1  cb 40 61 ee  e3 0c 74 0a  e4 7a ee dc
|   6d fa 17 22  69 26 bc 2d  87 10 f4 56  60 ad 19 9b
|   0c 04 1b e5  8c d3 f0 dd  22 ab 92 d0  05 53 00 65
|   4b dc 35 bd  ad a5 89 69  b5 1e bb 69  af 84 87 84
|   77 80 2d 26  2f 08 b4 49  1b a9 36 2d  82 51 c2 58
|   f6 cf ab 59  c6 57 cd 19  58 8b fc 71  7b 60 7d fa
|   fe 14 7b 3a  c3 ef 2e dd  34 c6 e0 35  74 95 6b ad
|   10 b0 d9 9b  4c 81 02 2d  36 b5 23 1d  50 5e f3 5d
|   a4 05 8d a7  04 11 52 36  21 67 4b b1  40 37 ba 12
|   40 1b 37 21  6a 9b 32 60  b6 e0 be 53  63 07 44 66
|   96 33 bf 95  e2 f5 1e 2e  99 0e f2 bb  a0 6a 1b 6d
|   0b b6 3c 95  72 1b fe 86  f8 1a df 6d  44 dd 3c 1d
|   22 61 22 3d  da 9a 55 87  05 9c 0f 35  d4 6d 71 d4
|   be a5 3b 8a  b2 5a 2a 28  9a a6 2a fa  5b 9b ac c9
|   b6 f6 46 10  4a 4d 79 5b  80 13 1b dc  e6 b8 53 90
|   e1 d9 54 eb  ed 94 ff 9d  c2 09 b9 d1  f8 1e af ac
|   a1 8c c6 63  d4 9e d8 d4  e1 6d 4b 36  01 6f 9d 79
|   c5 66 54 cc  73 1f 00 2d  d4 05 eb b9  99 f3 38 39
|   30 fb 92 a1  a4 e0 05 ec  fa 8c 43 97  86 be 67 34
|   ba 25 fb 76  f7 36 b4 3e  9a 2d f5 62  9c 14 b4 bf
|   5e 83 48 a5  26 f6 96 b8  db 16 59 ed  21 2d d9 06
|  processing version=2.0 packet with exchange type=ISAKMP_v2_AUTH (35), msgid: 00000001
| I am the IKE SA Responder
| I am this exchange's Responder
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  78 5b 90 fe  dd d1 18 2d
| state hash entry 6
| v2 state object not found
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  78 5b 90 fe  dd d1 18 2d
| state hash entry 6
| v2 peer and cookies match on #2
| v2 state object #2 (peerB--peerA) found, in STATE_PARENT_R1
| state found and its state is:STATE_PARENT_R1 msgid: 00001
| now proceed with state specific processing using state #4 responder-auth-process
| #2 complete v2 state transition with STF_SUSPEND
./peerB-R2S IKEv2 mode peer ID is ID_DER_ASN1_DN: 'C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org'
./peerB-R2S v2_CERT received on reponder, attempting to validate
./peerB-R2S no crl from issuer "C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA" found (strict=no)
| reached self-signed root ca
./peerB-R2S 0: validated X509 certificate: 'C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org', added to trusted database
| requested CA keyID  86 cb 59 12  06 07 df 3f  00 36 b9 64  c6 c5 14 1f
|   3a ed cd aa
| ikev2 verify required CA is 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|
| List of X.509 End Certificates:
|
| NOW, count: 1
|        subject: 'C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org'
|        issuer:  'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|        serial:   05
|        pubkey:   2048 RSA Key AwEAAbfz1
|        validity: not before Sep 03 04:15:59 UTC 2019 ok
|                  not after  Dec 11 04:15:59 UTC 2021 ok
|        subjkey:  5c:59:70:62:57:2d:2a:24:9c:5c:94:56:9b:89:5e:e5:c5:05:b6:bd
|        authkey:  86:cb:59:12:06:07:df:3f:00:36:b9:64:c6:c5:14:1f:3a:ed:cd:aa
| checking alg=1 == 1, keyid=dave@openswan.org same_id=0
| checking alg=1 == 1, keyid=carol@openswan.org same_id=0
| checking alg=1 == 1, keyid=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org same_id=0
| checking alg=1 == 1, keyid=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org same_id=1
| key issuer CA is 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
| PARENT SA now authenticated, building child and reply
| IKEv2 thinking whether to send my certificate:
|  my policy has  RSASIG, the policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|  sendcert: CERT_ALWAYSSEND and I did get a certificate request
|  so send cert.
| Thinking about sending a certificate request (CERTREQ)
|   my policy is : RSASIG+ENCRYPT+TUNNEL+PFS+OVERLAPIP+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   my next payload will not be a certificate request
| I did not send a certificate request (CERTREQ) because
|   already received a CERT from peer
./peerB-R2S received CHILD SA proposal(s) will be processed
| ei->port 0  tsi[tsi_ni].startport 0  tsi[tsi_ni].endport 65535
|     evaluate_connection_port_fit tsi_n[1], best=-1
|    tsi[0] 0-65535: exact port match with 0.  fitness 65536
|       evaluating_connection_port_fit tsi_n[0], range_i=65536 best=-1
|    tsr[0] 0-65535: exact port match with 0.  fitness 65536
|       evaluating_connection_port_fit tsi_n[0] tsr_n[0], range=65536/65536 best=-1
|     best ports fit so far: tsi[0] fitrange_i 65536, tsr[0] fitrange_r 65536, matchiness 131072
|     port_fitness 131072
| instantiated "peerB--peerA" for fe80::8054:3eff:fe9a:d3f4
./peerB-R2S switched from "peerB--peerA" to "peerB--peerA"[1]
| duplicating state object #2
| creating state object #4 at Z
| ICOOKIE:  8d 0e 0f 10  11 12 13 14
| RCOOKIE:  78 5b 90 fe  dd d1 18 2d
| state hash entry 6
| inserting state object #4 bucket: 6
| #4 complete v2 state transition with STF_OK
./peerB-R2S transition from state STATE_PARENT_R1 to state STATE_PARENT_R2
| v2_state_transition: st is #4; pst is #2; transition_st is #2
./peerB-R2S STATE_PARENT_R2: received v2I2, PARENT SA established {auth=IKEv2 oursig=fakesig2 theirsig=fc1 cipher=aes_128 integ=sha256_128 prf=prf-hmac-sha2-256 group=modp2048} (msgid: 00000001/00000001)
./peerB-R2S negotiated tunnel [::,ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff proto:0 port:0-65535] -> [::,ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff proto:0 port:0-65535]
./peerB-R2S STATE_CHILD_C1_KEYED: CHILD SA established tunnel mode {ESP=>0x12345678 <0x34567812 xfrm=aes_cbc_128-hmac_sha2_256_128 NATOA=none NATD=none DPD=none VTImark=00002703}
| sending reply packet to fe80::8054:3eff:fe9a:d3f4:500 (from port 500)
sending 1552 bytes for STATE_PARENT_R1 through eth0:500 [fe80::ec68:7cff:fe0c:9aa4:500] to fe80::8054:3eff:fe9a:d3f4:500 (using #4)
|   8d 0e 0f 10  11 12 13 14  78 5b 90 fe  dd d1 18 2d
|   2e 20 23 20  00 00 00 01  00 00 06 10  24 00 05 f4
|   97 18 19 1a  1b 1c 1d 1e  1f 20 21 22  23 24 25 26
|   4e 05 78 72  87 19 97 02  2c 37 57 f8  96 c3 88 27
|   02 23 a8 ef  55 89 69 0e  79 74 b1 d6  22 aa cd a1
|   dd aa 0b 11  15 0d 2d 61  07 98 a5 a9  f2 b6 79 ea
|   5d b2 31 9d  8e dd 44 04  d5 97 10 62  7b a2 94 62
|   10 0e b4 04  94 0b f9 59  5d 77 79 15  f6 09 fd 5d
|   b1 9f 23 34  42 91 be 82  60 c6 14 d6  46 3d 0f 87
|   08 87 3e c8  be 02 72 f8  e6 18 43 0b  74 0a b5 e2
|   02 b2 8f 73  f8 3a 3a 52  25 bc 8e f3  6d eb f0 66
|   53 e5 d6 27  b6 f8 eb 3c  60 c8 cf b8  78 cc fd 1f
|   af 53 e0 d5  26 d2 e5 26  ef 6d c8 2f  e5 bc ae 3e
|   67 c2 f8 ae  9a 76 2d db  fd b8 eb ae  42 19 fb 3f
|   0b 8c 1e 6c  c8 06 86 73  78 f3 8d 10  ab 3d 24 13
|   54 92 dd 8d  b8 90 e2 26  d9 c0 2a 00  a1 4c 35 58
|   7f 8d ac 07  4f 61 55 63  db b5 54 a4  8c 57 ee a7
|   78 8a ef 6b  29 33 3b 97  80 a1 40 73  45 f0 70 55
|   34 30 82 58  8e 29 69 57  5f 40 10 44  53 10 4e f7
|   89 7a 81 76  a1 5a a2 ab  c1 fc c7 dd  25 13 bb 4f
|   95 7e ef 17  01 88 70 b7  58 46 a7 7e  66 e2 3f 1c
|   77 24 56 88  86 f3 fb a0  e8 9f e9 24  da ef b8 9a
|   bb 41 c7 29  35 71 b3 43  85 df a8 5f  80 46 6d 88
|   d3 b8 ab d5  50 5f 4c 0a  05 45 c7 f1  6b ad b4 54
|   99 be 93 8c  b0 b4 53 3f  7a 96 57 ae  c9 75 cf 45
|   69 f0 87 e2  db 40 9e 9a  f2 a2 17 51  f5 3e 42 49
|   51 bc a1 b2  a1 b9 0a 32  fd 8c 2a e6  df 95 b8 de
|   53 13 eb 62  2e c6 5e 8b  4e 3b 58 c3  c9 d1 55 fe
|   98 1c c8 51  cd 49 49 f5  66 4f 8f 75  d8 9a bf 58
|   9c 53 f9 34  4f a0 4a c8  da 91 52 ff  7c 51 54 4b
|   0f 8f 5f 75  a1 b8 06 f9  2f 6c b1 5a  dd 15 dc 0c
|   83 16 9d 8e  e0 35 1e 09  eb 92 47 cd  ec 3a 32 03
|   da 50 6c 67  ac 15 f6 73  62 5a 95 b4  ea 81 c8 d1
|   77 2f 5e 72  24 aa f6 cd  aa 8c 66 96  10 17 fd 22
|   96 ce 1f b0  f4 e0 96 a1  e4 54 45 0f  7b bd a1 27
|   cc f1 98 99  b8 3f 0d 5c  df 94 5e 89  40 73 98 bd
|   1b bc af ec  f6 c6 ad 65  89 5c 05 f8  96 4e 7d 18
|   9e 03 92 b9  25 c9 80 3e  1d b1 26 e0  39 fd 78 56
|   13 d7 55 aa  fb e8 aa c7  5f 3c c3 ab  bd b2 6b ca
|   62 48 87 54  79 6b 3c b3  05 ae 6d be  62 5b a3 6c
|   9a 6a 20 70  77 2b 99 58  af 87 bb 60  e9 88 72 b3
|   6e 68 bb db  4c fc 7b e3  e8 ce 0f e8  12 bc 15 b7
|   d1 56 21 77  11 77 cc 0c  ba 99 76 23  83 fa ea 78
|   42 75 53 86  31 40 02 24  36 97 16 53  a9 0f 01 69
|   95 0c 7b 1d  15 3e 15 57  32 e0 57 54  e8 37 b8 1d
|   69 b4 d9 ed  33 fc 16 2a  95 57 20 9e  bc 12 e2 8c
|   03 8b 46 5a  59 f9 3c 8c  0d 5e 1e 01  81 e5 b9 ea
|   7b 92 64 23  de ba f4 06  5e 5b e1 25  f2 c7 89 51
|   51 a3 ba 4d  a7 e5 c6 52  40 b6 b9 b7  35 0f 8f 77
|   c8 50 72 30  44 aa 7d 6d  47 9b 84 06  6a c2 d2 aa
|   70 ea 64 98  4f 99 d1 63  7e c3 b1 3c  ce a4 8e 56
|   0a 92 f7 ef  61 a5 0c df  fe ba 8d 90  b0 d6 d0 32
|   e4 4c bb f5  20 f1 45 aa  03 4b 28 bd  54 a4 18 e0
|   a5 84 1e be  30 46 e5 58  80 c1 52 66  9e b0 05 ee
|   52 a7 1a 99  76 b8 ab a1  8e bb 07 98  4e c5 23 1d
|   7f 16 66 e5  3d bf 66 2b  d0 36 61 2f  22 d7 c3 38
|   4a f5 0f 36  a7 fe 3f 90  fa b4 56 d1  2d 1b 62 77
|   a6 88 fc 7e  57 ae 65 fa  e3 31 75 22  75 52 b8 5e
|   bb ce 53 6d  db eb 43 17  59 e5 fe ae  e4 f5 32 6d
|   d4 64 4a 3b  21 93 4e 88  82 20 0d ca  77 9f 17 f8
|   e5 26 30 4f  d2 65 d3 da  36 28 a1 11  b9 46 03 9c
|   47 74 f4 67  38 ee 9b 47  d1 be f8 eb  8b 25 5b 8d
|   13 85 39 a5  98 80 a7 bb  c2 52 63 47  c7 09 0f bf
|   54 a3 0f 07  0f bb 15 f7  27 9f 10 af  13 30 d8 a9
|   96 67 61 f7  af b6 dc 4f  e7 7f bb 6d  99 b3 bc 55
|   42 45 b2 c4  15 c6 53 cc  81 f0 98 d2  4a a0 a3 44
|   cf e6 14 b5  6f b1 6f a7  78 64 26 bf  16 96 ac 82
|   07 b4 62 0d  39 59 a5 be  21 9d 6a b4  05 35 cf 02
|   7d 66 95 6f  53 0b ae 93  49 3e cf 64  a9 46 6a 9c
|   25 03 b6 e6  84 81 e3 90  0a f7 45 40  24 6e 95 da
|   46 bb 3d 18  83 ec c4 b7  e8 40 90 98  9d 05 c8 38
|   de af b9 50  ee 6e 8b 4d  c9 a2 a0 e0  85 30 e4 f0
|   7b 7f 96 6c  8b 04 cb ab  6f 0c c8 0d  c5 d1 bd d4
|   74 9c 58 c7  c5 f0 16 77  c9 34 c6 59  9a d5 fb f9
|   69 6d 3d e1  1c 31 2f 6c  4f 87 ce 18  22 16 42 89
|   cf 6b 61 44  8c 1c 3b e3  04 ab fa 38  1c ba 1e 5b
|   d2 89 17 fb  04 06 d2 26  2b dc 79 18  3c 82 b0 ad
|   5d c3 77 80  ca d7 67 54  7d 4f 17 1e  b8 15 15 9a
|   f5 74 1e 66  29 dd eb 53  82 77 81 11  39 69 e3 8b
|   c1 12 d2 65  69 b7 0d 34  cb d0 f6 81  2c 01 53 96
|   82 b2 05 4f  84 4d 71 93  92 fe 5a d2  f8 e0 a8 d8
|   58 c7 42 fa  1b d9 af c2  01 db dc 3f  56 8f 05 b3
|   81 a1 ff a9  00 79 8a 59  f7 61 06 34  b6 72 39 dd
|   91 58 d2 c2  7f f7 b1 73  91 dc 4f 4e  cc 7f ec d6
|   62 26 47 ae  be 13 e5 de  43 08 26 6c  a0 ad 33 01
|   d5 17 ec 22  f5 9f 96 19  48 97 85 c8  2c f4 be 82
|   f3 7c 19 97  74 76 fc dd  5c c4 8b ac  98 23 0e 38
|   ea 07 9d 0b  49 03 9a 97  c9 4f c3 65  71 cc a9 f9
|   e0 ca 1c 9f  92 54 52 90  df cb 41 3a  db c3 bc 80
|   f1 60 e7 5d  e1 32 91 42  2f cc 78 30  71 2b 27 68
|   bb f1 b0 81  de 05 a7 63  fe 6c a1 da  f8 68 e7 de
|   35 fb f6 52  34 c8 16 b7  52 fa ea 8f  b4 af aa 0d
|   97 0d c1 7a  55 fd 5e 97  c5 dd 97 9a  06 21 4e 36
|   d9 31 6e ca  7c 9b 40 e5  c6 35 0b 13  a0 cd 64 68
|   4e 45 0b 00  e4 b5 45 03  69 9e e4 f5  3d a8 ac 45
|   5e f7 e7 1f  9a db 4b 16  cf 5a 1a 29  4e 61 9e b7
|   af a4 96 f1  da e1 6e 6e  a8 d7 4f 71  40 7b 55 f2
| releasing whack for #X (sock=Y)
| releasing whack for #X (sock=Y)
RC=0 #3: "peerB--peerA":500 IKEv2.0 STATE_CHILD_C0_KEYING (CHILD SA keying); none in -1s; nodpd; msgid=1; idle; import:admin initiate
RC=0 #3: "peerB--peerA":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=*
RC=0 #1: "peerB--peerA":500 IKEv2.0 STATE_PARENT_I2 (sent v2I2, expected v2R2); none in -1s; nodpd; retranscnt=0,outorder=0,last=0,next=2,recv=-1; msgid=0; idle; import:admin initiate
RC=0 #1: "peerB--peerA":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=*
RC=0 #4: "peerB--peerA"[1] fe80::8054:3eff:fe9a:d3f4:500 IKEv2.0 STATE_CHILD_C1_KEYED (CHILD SA established); none in -1s; newest IPSEC; nodpd; msgid=0; idle; import:respond to friend
RC=0 #4: "peerB--peerA"[1] fe80::8054:3eff:fe9a:d3f4:500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org
RC=0 #2: "peerB--peerA"[1] fe80::8054:3eff:fe9a:d3f4:500 IKEv2.0 STATE_PARENT_R2 (received v2I2, PARENT SA established); none in -1s; nodpd; retranscnt=0,outorder=0,last=-1,next=0,recv=1; msgid=0; idle; import:respond to friend
RC=0 #2: "peerB--peerA"[1] fe80::8054:3eff:fe9a:d3f4:500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org
| duplicate parent SA looking for state matching for peerB--peerA #2
| failed to match ID1: A{C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org} vs B{C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org}
| failed to match ID2: A{C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org} vs B{C=CA, ST=ON, O=Xelerance, CN=*}
| states had different identities
3: output to OUTPUT/02_peerB-R2S.pcap
3: input from peerA-R2a.pcap
|   =========== input from pcap file peerA-R2a.pcap ========
| *received 1552 bytes from fe80::8054:3eff:fe9a:d3f4:500 on eth0 (port=500)
|   97 18 19 1a  1b 1c 1d 1e  97 03 67 ba  2d 8b a4 1d
|   2e 20 23 20  00 00 00 01  00 00 06 10  24 00 05 f4
|   8d 0e 0f 10  11 12 13 14  15 16 17 18  19 1a 1b 1c
|   ae e3 fe 75  ce 32 e4 53  47 b1 a6 cc  42 b7 95 66
|   71 a7 32 f7  c8 ad af bf  d1 16 fe 5a  24 5b 25 33
|   8d 5d 24 30  30 0b 2c e2  f2 47 95 d1  9a 99 30 d5
|   52 f7 3f d0  a5 5f fc 41  15 d4 a2 7a  4c c4 f0 57
|   ed 0d f2 06  94 7f 77 90  0c 68 73 d1  b4 0f ee 9d
|   86 e9 78 89  27 7e 0b c3  fe 63 7e 1b  a7 49 fb 36
|   da b0 a5 20  af ee df 86  22 c5 c8 9e  e9 8d a8 b8
|   36 f4 29 f2  c5 17 fe 7a  da ef 05 95  27 31 be f9
|   a1 84 39 92  6c 78 1c ae  3a 63 c5 36  a9 13 c0 46
|   cc e8 45 37  32 bf 35 07  5a 9d 8f 6a  b9 33 1d a8
|   21 ab fe fd  02 e5 7c 35  59 7d f7 b3  a7 99 c2 ed
|   90 4b 8f a1  87 4f 74 0d  00 e1 b4 58  f0 03 63 11
|   28 a9 36 c8  a6 71 8b f0  62 42 eb 16  7f 64 f0 01
|   dd ce f4 3a  52 b2 ab e9  c4 7f fe 02  45 33 6f b6
|   a4 fc 49 e9  15 f7 0c 17  e4 5f fa b1  b9 82 1d 48
|   30 e0 1c 11  26 96 1f 95  3f 33 eb 4b  68 c6 38 28
|   21 87 d4 60  5d 1f ff 20  9c 56 7b 27  3c 88 41 77
|   50 28 c7 3f  96 f1 43 c6  9c 9f 0e 83  9c 2b 0c 16
|   f9 6f 1d 79  bd f4 14 85  72 ef db c7  a6 93 36 9b
|   c0 28 1e c7  4e da 14 23  00 00 1d 06  d2 0b 01 3d
|   2b 9f c1 08  a1 52 94 bd  b3 84 87 bd  93 fd 89 04
|   f5 b4 fd 11  6e 6d e2 fd  76 22 b4 b7  71 c1 c7 99
|   70 77 bb 8a  31 8c bc 5b  67 a4 36 3d  aa 1e 49 99
|   cd c8 79 d1  37 67 49 c2  e0 ba 38 cd  15 7e 7e 63
|   a3 96 0c bb  95 bf ab 2f  6a 73 7e 61  ff d2 f8 b7
|   1d 14 34 89  e7 58 61 ad  bc 1f 2b bb  c2 a2 68 6b
|   8e ee f0 10  18 b0 6a bd  13 54 fd 43  6d e2 75 34
|   43 2f b1 ec  d9 19 b9 3a  96 e7 e6 ba  a8 70 73 de
|   77 76 29 cc  73 99 db 53  d0 0b 43 41  1d db 6a 18
|   d4 d2 d9 80  c8 7e ac 85  af c9 5e 23  00 77 f2 66
|   3f de bb 4b  6e ca d9 ed  c6 36 72 9d  5d 55 8b 89
|   e1 8e c4 80  aa db f8 41  94 ee 21 0a  4b 4f b2 f9
|   e2 be 38 fa  5e 5a 49 63  c1 20 d6 38  bf a9 84 21
|   2d da 72 9a  59 5d 06 3d  a5 0a 43 c4  d8 d5 0a dd
|   a6 10 ed 13  5f c9 28 ae  5e 2f ef f7  c1 fe 97 07
|   72 c8 5b 4b  b7 fd f6 1e  6b b5 88 9e  8c e0 73 ac
|   86 de 52 d9  d4 6b 02 d7  a3 34 0b e3  27 86 16 34
|   dd ea 1a 35  7a b3 cb 77  6a cb 19 0e  8e cc b5 03
|   90 06 a0 08  61 5e 03 35  76 be be 16  64 99 a8 cd
|   5a b9 13 6b  af be 2c 19  6f 4f 88 45  b5 a9 bf f2
|   14 7e cd 1b  11 26 97 a1  95 23 05 b9  96 d8 00 15
|   68 68 9b 1d  87 16 e7 11  f0 b7 f2 92  2a fc bc 8d
|   5e fa 08 47  bc 71 e7 92  ac d2 6f bf  63 a5 6f 68
|   38 0d 64 80  df 50 77 e0  1c 22 aa 4f  db 90 30 6c
|   d9 40 fb bc  23 24 15 e9  bc 3a d3 13  b6 05 89 84
|   38 06 b5 4f  3c 99 5f ed  2e bd 9e 56  4a b1 5d 72
|   6e ea 43 23  c0 91 c8 b1  9a 6f 74 41  84 02 83 bf
|   83 0c 4a 4d  61 f9 db 90  9c 89 8e 24  bf aa b2 af
|   1d f1 5d 25  3c 23 82 30  9e 43 97 fd  e1 d3 5f 9e
|   e0 3c 19 c0  10 d6 d1 16  17 bc b0 24  b4 e7 11 ff
|   92 cd 75 df  ba 27 d9 8a  2c f0 45 ef  0f 40 80 f5
|   dd a7 d7 c5  e3 96 8e 68  81 63 7f 8f  cb af 28 6e
|   41 1f 6e af  88 75 e2 ea  27 5e 5f 0e  12 6c b9 fc
|   32 7d 73 85  34 9a 9d 2c  46 08 b9 d8  7b e7 52 ef
|   8f e5 61 e3  cd 2d 2c f3  dc 8c 45 e7  01 1a 71 23
|   db f5 ce 38  96 53 64 e4  d4 74 3f e6  5c b9 db de
|   e7 68 d8 bc  1c 59 df 21  d2 58 a1 cd  89 d8 6a 9e
|   e5 a0 de c4  c1 0b c5 c3  20 5a 10 3e  74 ee 11 a5
|   25 55 48 cf  fa 30 15 72  c6 ef 22 53  6e 75 81 a7
|   90 6b 08 43  eb e7 f2 cb  e5 5e 06 72  e6 e9 ca e0
|   70 51 4b 33  e4 28 ed 38  a8 55 91 9f  fb b5 54 21
|   9b a6 3d 92  0f a4 2d a9  33 b7 3b 1b  62 e2 86 d5
|   b9 b2 c8 23  aa 4a a2 ef  45 67 90 e4  c0 5b d2 ae
|   34 eb 9e 51  e3 40 34 13  bb bc 83 e3  6e 0d 2e f4
|   fc 22 a6 d1  1a 0f 93 8d  28 91 3a 19  24 0a 41 71
|   29 5d ea b9  1d dc 5b cd  a2 a4 a6 4f  a2 4d e0 98
|   b1 96 9b 8b  6c 1c 19 ed  14 20 22 dc  42 f6 2f 28
|   18 21 9c ce  35 9b aa d7  57 06 c5 7a  72 92 5c 64
|   87 f8 5e d2  7b 06 85 a8  47 00 52 9a  54 c4 67 ad
|   9d 13 1c e8  d3 e8 14 89  08 fb bc 5e  2e f6 d0 ba
|   d7 d2 07 75  ae 4d e2 22  cd 53 0e 3f  ca 94 76 23
|   5b cb 0c 4b  3f 0d 10 07  a2 83 3c f6  68 5e 0a cc
|   54 f4 72 67  07 c5 ab 66  e4 7b 9a 28  6a 98 3f e6
|   2f 7d af f6  0b 2e 4a 01  03 12 e0 6a  9c a3 96 aa
|   b6 c1 f8 08  dd b4 66 9b  bf 48 af 00  bc 5a 81 d6
|   26 f2 f7 8c  26 c7 44 f8  ce 9a 64 23  9a a0 85 90
|   04 37 91 62  36 e0 c4 25  32 71 85 4c  92 4c 83 2e
|   8c 6b e9 75  94 e5 5b c5  0f ee 61 b5  ec 12 e6 03
|   70 6c 2f 7e  91 4e 1f 7b  ff 3a 87 ca  85 66 37 b3
|   6d 7d 29 49  29 c7 52 6d  ae d9 22 4c  55 ed 9c 9b
|   c8 5b 23 ea  38 65 00 13  be 43 46 77  eb 95 4e 90
|   dd 63 b8 ab  b7 35 5a d4  2d 9d 64 db  00 74 b2 64
|   15 b3 19 ac  4e 0c 2e ac  34 7d d9 cf  04 8a cb 10
|   68 59 30 08  ce f4 f8 4d  4e 69 41 57  c0 be e9 ad
|   70 8c d5 64  b2 26 e0 27  bc 87 11 af  86 15 89 2e
|   96 36 8a bf  c1 85 0d de  47 9d 45 06  72 13 e4 c8
|   89 93 33 62  56 14 03 db  34 dd 49 be  aa 54 11 b9
|   ea ea 72 a0  79 d8 0b bb  8a 41 d3 0d  ed 0c bc ee
|   ac 9c 2a 40  64 4c 14 7e  28 dd 2a 0e  9f 8d 6e b6
|   33 2a 87 ce  01 eb 83 ef  c2 b3 e1 e9  4e 93 9f 48
|   0c 51 ce d1  75 ab 81 09  60 5f 57 fe  aa 47 21 6e
|   76 11 e7 6f  85 e9 10 02  2b f3 77 1c  a9 18 21 5e
|   35 e6 43 37  ce 7a 75 27  b5 5f 7d c9  43 1b f5 65
|   13 65 68 84  ff 40 91 56  d4 6e 7d 5c  2a af 7f f9
|  processing version=2.0 packet with exchange type=ISAKMP_v2_AUTH (35), msgid: 00000001
| I am the IKE SA Initiator
| I am this exchange's Initiator
| ICOOKIE:  97 18 19 1a  1b 1c 1d 1e
| RCOOKIE:  97 03 67 ba  2d 8b a4 1d
| state hash entry 2
| v2 peer, cookies and msgid match on #3
| v2 state object #3 found, in STATE_CHILD_C0_KEYING
| state found and its state is:STATE_CHILD_C0_KEYING msgid: 00001
| now proceed with state specific processing using state #2 initiator-auth-process
./peerB-R2S IKEv2 mode peer ID is ID_DER_ASN1_DN: 'C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org'
./peerB-R2S v2_CERT received on initiator, attempting to validate
./peerB-R2S no crl from issuer "C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA" found (strict=no)
| reached self-signed root ca
./peerB-R2S 0: validated X509 certificate: 'C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org', added to trusted database
| ikev2 verify required CA is 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|
| List of X.509 End Certificates:
|
| NOW, count: 2
|        subject: 'C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org'
|        issuer:  'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
|        serial:   05
|        pubkey:   2048 RSA Key AwEAAbfz1
|        validity: not before Sep 03 04:15:59 UTC 2019 ok
|                  not after  Dec 11 04:15:59 UTC 2021 ok
|        subjkey:  5c:59:70:62:57:2d:2a:24:9c:5c:94:56:9b:89:5e:e5:c5:05:b6:bd
|        authkey:  86:cb:59:12:06:07:df:3f:00:36:b9:64:c6:c5:14:1f:3a:ed:cd:aa
| checking alg=1 == 1, keyid=dave@openswan.org same_id=0
| checking alg=1 == 1, keyid=carol@openswan.org same_id=0
| checking alg=1 == 1, keyid=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org same_id=0
| checking alg=1 == 1, keyid=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org same_id=1
| key issuer CA is 'C=CA, ST=ON, L=Ottawa, O=Xelerance, CN=Openswan Unit Testing Root CA'
| ei->port 0  tsi[tsi_ni].startport 0  tsi[tsi_ni].endport 65535
|     evaluate_connection_port_fit tsi_n[1], best=-1
|    tsi[0] 0-65535: exact port match with 0.  fitness 65536
|       evaluating_connection_port_fit tsi_n[0], range_i=65536 best=-1
|    tsr[0] 0-65535: exact port match with 0.  fitness 65536
|       evaluating_connection_port_fit tsi_n[0] tsr_n[0], range=65536/65536 best=-1
|     best ports fit so far: tsi[0] fitrange_i 65536, tsr[0] fitrange_r 65536, matchiness 131072
|     port_fitness 131072
| protocol 0 and tsi[0].ipprotoid 0: exact match
| protocol 0 and tsr[0].ipprotoid 0: exact match
|     best protocol fit so far: tsi[0] fitrange_i 255, tsr[0] fitrange_r 255, matchiness 510
|     protocol_fitness 510
| #3 complete v2 state transition with STF_OK
./peerB-R2S transition from state STATE_CHILD_C0_KEYING to state STATE_CHILD_C1_KEYED
| v2_state_transition: st is #3; pst is #0; transition_st is #0
./peerB-R2S STATE_CHILD_C1_KEYED: CHILD SA established (msgid: 00000001/4294967295)
./peerB-R2S negotiated tunnel [::,ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff proto:0 port:0-65535] -> [::,ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff proto:0 port:0-65535]
./peerB-R2S STATE_CHILD_C1_KEYED: CHILD SA established tunnel mode {ESP=>0x34567812 <0x12345678 xfrm=aes_cbc_128-hmac_sha2_256_128 NATOA=none NATD=none DPD=none VTImark=00002703}
| releasing whack for #X (sock=Y)
| releasing whack for #X (sock=Y)
RC=0 #3: "peerB--peerA":500 IKEv2.0 STATE_CHILD_C1_KEYED (CHILD SA established); none in -1s; newest IPSEC; nodpd; msgid=1; idle; import:admin initiate
RC=0 #3: "peerB--peerA":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=*
RC=0 #1: "peerB--peerA":500 IKEv2.0 STATE_PARENT_I3 (PARENT SA established); none in -1s; newest ISAKMP; nodpd; retranscnt=0,outorder=0,last=1,next=2,recv=-1; msgid=0; idle; import:admin initiate
RC=0 #1: "peerB--peerA":500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org
RC=0 #4: "peerB--peerA"[1] fe80::8054:3eff:fe9a:d3f4:500 IKEv2.0 STATE_CHILD_C1_KEYED (CHILD SA established); none in -1s; newest IPSEC; nodpd; msgid=0; idle; import:respond to friend
RC=0 #4: "peerB--peerA"[1] fe80::8054:3eff:fe9a:d3f4:500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org
RC=0 #2: "peerB--peerA"[1] fe80::8054:3eff:fe9a:d3f4:500 IKEv2.0 STATE_PARENT_R2 (received v2I2, PARENT SA established); none in -1s; nodpd; retranscnt=0,outorder=0,last=-1,next=0,recv=1; msgid=0; idle; import:respond to friend
RC=0 #2: "peerB--peerA"[1] fe80::8054:3eff:fe9a:d3f4:500 IKEv2.0 me=C=CA, ST=ON, O=Xelerance, CN=carol@openswan.org him=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org
| duplicate parent SA looking for state matching for peerB--peerA #1
| same parents matches A-->B
| state #2 matches #1
./peerB-R2S state #2 duplicates #1, deleting #2
| deleting state with nonce:
|   20 98 9d 37  a8 14 a6 4d  8f f0 7c 08  d3 20 e9 e3
./peerB-R2S deleting state #2 (STATE_PARENT_R2)
| considering request to delete IKE parent state
| sending IKE SA delete request
sending 80 bytes for ikev2_delete_out through eth0:500 [fe80::ec68:7cff:fe0c:9aa4:500] to fe80::8054:3eff:fe9a:d3f4:500 (using #2)
|   8d 0e 0f 10  11 12 13 14  78 5b 90 fe  dd d1 18 2d
|   2e 20 25 00  00 00 00 00  00 00 00 50  2a 00 00 34
|   97 18 19 1a  1b 1c 1d 1e  1f 20 21 22  23 24 25 26
|   ce d3 c1 42  91 16 1b 0e  54 23 58 3e  10 8a 3b b2
|   79 f5 94 24  4f ee 8b a7  3b 75 f2 64  1d 3f 54 de
should have found a continuation, but none was found
